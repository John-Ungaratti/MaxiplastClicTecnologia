<!DOCTYPE html>

<head>
	<meta charset="utf-8" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
		crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

</head>

<html style="font-size: small">

<div class="container-fluid">
	<div class="btn-group" role="group" aria-label="Default button group">
		<button id="abreModal" type="button" class="btn btn-outline-dark">Nova Cotação</button>
		&nbsp;
		<button type="button" class="btn btn-outline-dark">Cancelar Cotação / Orçamento</button>
		&nbsp;
		<button type="button" class="btn btn-outline-dark">Imprimir Orçamento / Pedido</button>
	</div>
</div>

<br>

<div class="container-fluid">
	<table id="orcamentosClic" class="table table-hover" style="font-size:90%">
		<thead>
			<tr style="text-align: center">
				<th scope="col">N° Cotação Clic</th>
				<th scope="col">Situação</th>
				<th scope="col">N° Orçamento ERP</th>
				<th scope="col">N° Pedido ERP</th>
				<th scope="col">Unidade</th>
				<th scope="col">Cliente</th>
				<th scope="col">Data de Geração</th>
				<th scope="col">Vendedor</th>
				<th scope="col"></th>
			</tr>
		</thead>
		<tbody id="tbodyOrcamentosClic">
		</tbody>
	</table>
</div>

<div id="modalSelectUnidade" class="modal" tabindex="-1" data-bs-backdrop="static">
	<div class="modal-dialog">
		<div class="modal-content" style="height: 180px;">
			<div class="modal-header">
				<h5 class="modal-title">Selecione a Unidade</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<select id="unidadeSelecionada" class="form-select" id="floatingSelect"
					aria-label="Floating label select example">
					<option selected disabled>Escolha uma unidade</option>
					<option value="Rafia">Rafia</option>
					<option value="Serafina">Flexível - Serafina</option>
					<option value="Matriz"> Flexível - Matriz</option>
				</select>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
				<button id="botaoSelUnidade" class="btn btn-primary">Confirmar</button>
			</div>
		</div>
	</div>
</div>

<!-- MODAL Rafia -->
<form id="formRafia">
	<div id="orcamentoRafia" class="modal" tabindex="-1" data-bs-backdrop="static">
		<div class="modal-dialog modal-fullscreen">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Edição de orçamento - Rafia</h5>
				</div>
				<div class="modal-body">
					<div class="mb-3">
						<label for="inputCliente" class="form-label">Cliente</label>
						<input id="filtroCliente" type="text" class="form-control" placeholder="Buscar cliente"
							list="clientes" required />
						<datalist id="clientes"></datalist>
					</div>
					<div class="mb-3">
						<label for="inputOrcamento" class="form-label">Orçamento</label>
						<input class="form-control" id="inputOrcamento" placeholder="Informe o tipo de orçamento"
							required>
					</div>
					<div class="mb-3">
						<label for="vendedorInput" class="form-label">Vendedor</label>
						<select name="vendedorInput" class="form-select" id="selectVendedor"></select>
					</div>
					<div>
						<label>Itens</label>
						<br>
						<button id="addItensRafia" type="submit" class="btn btn-outline-dark">Adicionar Item</button>
						<br>
					</div>
					<br>
					<div style="overflow-x: scroll">
						<table id="tableRafia" class="table table-bordered border-dark" style="font-size: small">
							<thead>
								<tr style="text-align: center;vertical-align: middle;">
									<th></th>
									<th scope="col">Item</th>
									<th scope="col">Unid. Medida</th>
									<th scope="col">Quantidade</th>
									<th scope="col">Preço</th>
									<th scope="col">Total</th>
									<th scope="col">Tipo Embalagem</th>
									<th scope="col">Convencional / Laminado</th>
									<th scope="col">Pigmentado / Transparente</th>
									<th scope="col">Liso / Impresso</th>
									<th scope="col">Quantidade Cores Frente </th>
									<th scope="col">Quantidade Cores Verso</th>
									<th scope="col">Gramatura Laminado</th>
									<th scope="col">Gramatura Convencional</th>
									<th scope="col">Cor Trama</th>
									<th scope="col">Cor Urdame</th>
									<th scope="col">Sanfona</th>
									<th scope="col">Medida Sanfona</th>
									<th scope="col">Válvula</th>
									<th scope="col">Medida Válvula</th>
									<th scope="col">Lyner</th>
									<th scope="col">Largura</th>
									<th scope="col">Comprimento</th>
									<th scope="col">Estado Destino</th>
									<th scope="col">Gramatura</th>
								</tr>
							</thead>
							<tbody id="linhaTableRafia">
							</tbody>
						</table>
					</div>
				</div>
				<div class="modal-footer">
					<button id="cancelaRafia" type="button" class="btn btn-secondary"
						data-bs-dismiss="modal">Cancelar</button>
					<button id="salvaRafia" type="button" onclick="salvaItensBaseClicRafia()"
						class="btn btn-primary">Salvar</button>
				</div>
			</div>
		</div>
	</div>
</form>

<!-- MODAL Rafia Produto -->
<form id="formProdutoRafia">
	<div id="modalSelectTipoItemRafia" class="modal fade" data-bs-backdrop="static">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Selecione a Opção</h5>
				</div>
				<div class="modal-body">
					<label for="inputProdutoRafia" class="form-label">Produto</label>
					<input class="form-control" type="text" list="produtos" id="inputProdutoRafia" disabled />
					<datalist id="produtos"></datalist>
					<br>
					<div class="container">
						<div class="row ">
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioRafia" type="radio" id="inputBrancoRafia"
									value="Novo Produto - Branco" onclick="disableInputRafia()" required>
								<label class="form-check-label" for="inputBrancoRafia">Novo Produto - Branco</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioRafia" type="radio" id="inputCopiaRafia"
									value="Novo Produto - Copiar" onclick="enableInputRafia()" required>
								<label class="form-check-label" for="inputCopiaRafia">Novo Produto - Copiar</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioRafia" type="radio"
									id="inputExistenteRafia" value="Produto já existente" onclick="enableInputRafia()"
									required>
								<label class="form-check-label" for="inputExistenteRafia">Produto já existente</label>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button id="cancelModalProdutoRafia" type="button" class="btn btn-secondary">Cancelar</button>
					<button id="confirmModalProdutoRafia" type="submit" class="btn btn-primary"
						onclick="addLinhas()">Confirmar</button>
				</div>
			</div>
		</div>
	</div>
</form>

<!-- MODAL Serafina -->
<form id="formSerafina">
	<div id="orcamentoSerafina" class="modal" tabindex="-1" data-bs-backdrop="static">
		<div class="modal-dialog modal-fullscreen">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Edição de orçamento - Flexível - Serafina</h5>
				</div>
				<div class="modal-body">
					<div class="mb-3">
						<label for="filtroClienteSerafina" class="form-label">Cliente</label>
						<input id="filtroClienteSerafina" type="text" class="form-control" placeholder="Buscar cliente"
							list="clientes" required />
						<datalist id="clientes"></datalist>
					</div>
					<div class="mb-3">
						<label for="inputOrcamentoSerafina" class="form-label">Orçamento</label>
						<input class="form-control" id="inputOrcamentoSerafina"
							placeholder="Informe o tipo de orçamento" required>
					</div>
					<div class="mb-3">
						<label for="filtroVendedorSerafina" class="form-label">Vendedor</label>
						<select name="filtroVendedorSerafina" class="form-select" id="selectVendedorSerafina"></select>
					</div>
					<div>
						<label>Itens</label>
						<br>
						<button id="addItensSerafina" type="submit" class="btn btn-outline-dark">Adicionar Item</button>
						<br>
					</div>
					<br>
					<div id="tableFlexivel" style="overflow-x: scroll">
						<table class="table table-bordered border-dark">
							<thead>
								<tr style="text-align: center;vertical-align: middle;">
									<th scope="col"></th>
									<th scope="col">Item</th>
									<th scope="col">Largura(cm)</th>
									<th scope="col">Altura(cm)</th>
									<th scope="col">Espessura(mm)</th>
									<th scope="col">Unid. Medida</th>
									<th scope="col">Quantidade</th>
									<th scope="col">Tipo Embalagem</th>
									<th scope="col">Monocamada / Laminado / Bilaminado</th>
									<th scope="col">Tipo Material</th>
									<th scope="col">Pigmentado / Transparente</th>
									<th scope="col">Liso / Impresso</th>
									<th scope="col">Quantidade Cores</th>
									<th scope="col">Tipo de Solda</th>
									<th scope="col">Prazo Entrega</th>
									<th scope="col">Obs</th>
									<th scope="col">Preço</th>
									<th scope="col">Total</th>
								</tr>
							</thead>
							<tbody id="linhaTableSerafina">
							</tbody>
						</table>
					</div>
				</div>
				<div class="modal-footer">
					<button id="cancelaSerafina" type="button" class="btn btn-secondary"
						data-bs-dismiss="modal">Cancelar</button>
					<button id="salvaSerafina" type="submit" class="btn btn-primary"
						onclick="salvaItensBaseClicSerafina()">Salvar</button>
				</div>
			</div>
		</div>
	</div>
</form>

<!-- MODAL Produto Serafina-->
<form id="formProdutoSerafina">
	<div id="modalSelectTipoItemSerafina" class="modal fade" tabindex="-1" data-bs-backdrop="static">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Selecione a Opção</h5>
				</div>
				<div class="modal-body">
					<label for="inputProdutoSerafina" class="form-label">Produto</label>
					<input id="inputProdutoSerafina" class="form-control" type="text" list="produtosSerafina"
						disabled />
					<datalist id="produtosSerafina"></datalist>
					<br>
					<div class="container">
						<div class="row ">
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioSerafina" type="radio"
									id="inputBrancoSerafina" value="Novo Produto - Branco"
									onclick="disableInputSerafina()" required>
								<label class="form-check-label" for="inputBrancoSerafina">Novo Produto - Branco</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioSerafina" type="radio"
									id="inputCopiaSerafina" value="Novo Produto - Copiar"
									onclick="enableInputSerafina()" required>
								<label class="form-check-label" for="inputCopiaSerafina">Novo Produto - Copiar</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioSerafina" type="radio"
									id="inputExistenteSerafina" value="Produto já existente"
									onclick="enableInputSerafina()" required>
								<label class="form-check-label" for="inputExistenteSerafina">Produto já
									existente</label>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button id="cancelModalProdutoSerafina" type="button" class="btn btn-secondary">Cancelar</button>
					<button id="confirmModalProdutoSerafina" type="submit" class="btn btn-primary"
						onclick="addLinhasSerafina()">Confirmar</button>
				</div>
			</div>
		</div>
	</div>
</form>

<!-- MODAL Matriz -->
<form id="formMatriz">
	<div id="orcamentoMatriz" class="modal" tabindex="-1" data-bs-backdrop="static">
		<div class="modal-dialog modal-fullscreen">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Edição de orçamento - Flexível - Matriz</h5>
				</div>
				<div class="modal-body">
					<div class="mb-3">
						<label for="filtroClienteMatriz" class="form-label">Cliente</label>
						<input id="filtroClienteMatriz" type="text" class="form-control" placeholder="Buscar cliente"
							list="clientes" required />
						<datalist id="clientes"></datalist>
					</div>
					<div class="mb-3">
						<label for="inputOrcamentoMatriz" class="form-label">Orçamento</label>
						<input class="form-control" id="inputOrcamentoMatriz" placeholder="Informe o tipo de orçamento"
							required>
					</div>
					<div class="mb-3">
						<label for="filtroVendedorMatriz" class="form-label">Vendedor</label>
						<select name="filtroVendedorMatriz" class="form-select" id="selectVendedorMatriz"></select>
					</div>
					<div>
						<label>Itens</label>
						<br>
						<button id="addItensMatriz" type="submit" class="btn btn-outline-dark">Adicionar Item</button>
						<br>
					</div>
					<br>
					<div id="tableMatriz" style="overflow-x: scroll">
						<table class="table table-bordered border-dark">
							<thead>
								<tr style="text-align: center;vertical-align: middle;">
									<th scope="col"></th>
									<th scope="col">Item</th>
									<th scope="col">Largura(cm)</th>
									<th scope="col">Altura(cm)</th>
									<th scope="col">Espessura(mm)</th>
									<th scope="col">Unid. Medida</th>
									<th scope="col">Quantidade</th>
									<th scope="col">Tipo Embalagem</th>
									<th scope="col">Monocamada / Laminado / Bilaminado</th>
									<th scope="col">Tipo Material</th>
									<th scope="col">Pigmentado / Transparente</th>
									<th scope="col">Liso / Impresso</th>
									<th scope="col">Quantidade Cores</th>
									<th scope="col">Tipo de Solda</th>
									<th scope="col">Prazo Entrega</th>
									<th scope="col">Obs</th>
									<th scope="col">Preço</th>
									<th scope="col">Total</th>
								</tr>
							</thead>
							<tbody id="linhaTableMatriz">
							</tbody>
						</table>
					</div>
				</div>
				<div class="modal-footer">
					<button id="cancelaMatriz" type="button" class="btn btn-secondary"
						data-bs-dismiss="modal">Cancelar</button>
					<button id="salvaMatriz" type="button" class="btn btn-primary"
						onclick="salvaItensBaseClicMatriz()">Salvar</button>
				</div>
			</div>
		</div>
	</div>
</form>

<!-- MODAL Matriz Produto -->
<form id="formProdutoMatriz">
	<div id="modalSelectTipoItemMatriz" class="modal fade" tabindex="-1" data-bs-backdrop="static">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Selecione a Opção</h5>
				</div>
				<div class="modal-body">
					<label for="inputProdutoMatriz" class="form-label">Produto</label>
					<input id="inputProdutoMatriz" class="form-control" type="text" list="produtosMatriz" disabled>
					<datalist id="produtosMatriz"></datalist>
					<br>
					<div class="container">
						<div class="row">
							<div class="form-check col">
								<input class="form-check-input" type="radio" name="flexRadioMatriz"
									id="inputBrancoMatriz" value="Novo Produto - Branco" onclick="disableInputMatriz()">
								<label class="form-check-label" for="inputBrancoMatriz">Novo Produto - Branco</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" type="radio" name="flexRadioMatriz"
									id="inputCopiaMatriz" value="Novo Produto - Copiar" onclick="enableInputMatriz()">
								<label class="form-check-label" for="inputCopiaMatriz">Novo Produto - Copiar</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" type="radio" name="flexRadioMatriz"
									id="inputExistenteMatriz" value="Produto já existente"
									onclick="enableInputMatriz()">
								<label class="form-check-label" for="inputExistenteMatriz">Produto já existente</label>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button id="cancelModalProdutoMatriz" type="button" class="btn btn-secondary">Cancelar</button>
					<button id="confirmModalProdutoMatriz" type="submit" class="btn btn-primary"
						onclick="addLinhasMatriz()">Confirmar</button>
				</div>
			</div>
		</div>
	</div>
</form>

<!-- MODAL EDIÇÃO -->
<div id="modalEdicao" class="modal" tabindex="-1">
	<div class="modal-dialog modal-fullscreen">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Edição Orçamento</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div id="corpoModalEdicao" class="modal-body">
				<div style="overflow-x: scroll">
					<table id="tableRafiaEdicao" class="table table-bordered border-dark" style="font-size: small">
						<thead>
							<tr style="text-align: center;vertical-align: middle;">
								<th></th>
								<th scope="col">Item</th>
								<th scope="col">Unid. Medida</th>
								<th scope="col">Quantidade</th>
								<th scope="col">Preço</th>
								<th scope="col">Total</th>
								<th scope="col">Tipo Embalagem</th>
								<th scope="col">Convencional / Laminado</th>
								<th scope="col">Pigmentado / Transparente</th>
								<th scope="col">Liso / Impresso</th>
								<th scope="col">Quantidade Cores Frente </th>
								<th scope="col">Quantidade Cores Verso</th>
								<th scope="col">Gramatura Laminado</th>
								<th scope="col">Gramatura Convencional</th>
								<th scope="col">Cor Trama</th>
								<th scope="col">Cor Urdame</th>
								<th scope="col">Sanfona</th>
								<th scope="col">Medida Sanfona</th>
								<th scope="col">Válvula</th>
								<th scope="col">Medida Válvula</th>
								<th scope="col">Lyner</th>
								<th scope="col">largura</th>
								<th scope="col">comprimento</th>
								<th scope="col">Estado Destino</th>
								<th scope="col">Gramatura</th>
							</tr>
						</thead>
						<tbody id="linhaTableRafiaEdicao">
							<div style="margin-bottom: 10px">
								<br>
								<button id="addItensRafiaEdicao" type="submit" class="btn btn-outline-dark"
									onclick="mostraModalProdutos()">Adicionar Item</button>
								<br>
							</div>
						</tbody>
					</table>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-bs-dismiss="modal"
					onclick="limparLinhasEdicao()">Fechar</button>
				<button type="button" class="btn btn-primary" onclick="atualizarItensBaseClicRafia()">Atualizar</button>
				<button type="button" class="btn btn-success" onclick="enviarWebServiceMaxiplastRafia()">Enviar</button>
			</div>
		</div>|
	</div>
</div>

<!-- MODAL EDICAO PRODUTOS RAFIA -->
<form id="formProdutoRafiaEdicao">
	<div id="modalSelectTipoItemRafiaEdicao" class="modal fade" data-bs-backdrop="static">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Selecione a Opção</h5>
				</div>
				<div class="modal-body">
					<label for="inputProdutoRafiaEdicao" class="form-label">Produto</label>
					<input class="form-control" type="text" list="produtos" id="inputProdutoRafiaEdicao" disabled />
					<datalist id="produtos"></datalist>
					<br>
					<div class="container">
						<div class="row ">
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioRafiaEdicao" type="radio"
									id="inputBrancoRafiaEdicao" value="Novo Produto - Branco"
									onclick="disableInputRafiaEdicao()" required>
								<label class="form-check-label" for="inputBrancoRafiaEdicao">Novo Produto -
									Branco</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioRafiaEdicao" type="radio"
									id="inputCopiaRafiaEdicao" value="Novo Produto - Copiar"
									onclick="enableInputRafiaEdicao()" required>
								<label class="form-check-label" for="inputCopiaRafiaEdicao">Novo Produto -
									Copiar</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioRafiaEdicao" type="radio"
									id="inputExistenteRafiaEdicao" value="Produto já existente"
									onclick="enableInputRafiaEdicao()" required>
								<label class="form-check-label" for="inputExistenteRafiaEdicao">Produto já
									existente</label>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button id="cancelModalProdutoRafiaEdicao" type="button" class="btn btn-secondary">Cancelar</button>
					<button id="confirmModalProdutoRafiaEdicao" type="submit" class="btn btn-primary"
						onclick="addLinhasEdicao()">Confirmar</button>
				</div>
			</div>
		</div>
	</div>
</form>

<!-- MODAL EDICAO SERAFINA-->
<div id="modalEdicaoSerafina" class="modal" tabindex="-1">
	<div class="modal-dialog modal-fullscreen">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Edição Orçamento</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div id="corpoModalEdicaoSerafina" class="modal-body">
				<div style="overflow-x: scroll">
					<table id="tableEdicaoSerafina" class="table table-bordered border-dark" style="font-size: small">
						<thead>
							<tr style="text-align: center;vertical-align: middle;">
								<th scope="col"></th>
								<th scope="col">Item</th>
								<th scope="col">Largura(cm)</th>
								<th scope="col">Altura(cm)</th>
								<th scope="col">Espessura(mm)</th>
								<th scope="col">Unid. Medida</th>
								<th scope="col">Quantidade</th>
								<th scope="col">Tipo Embalagem</th>
								<th scope="col">Monocamada / Laminado / Bilaminado</th>
								<th scope="col">Tipo Material</th>
								<th scope="col">Pigmentado / Transparente</th>
								<th scope="col">Liso / Impresso</th>
								<th scope="col">Quantidade Cores</th>
								<th scope="col">Tipo de Solda</th>
								<th scope="col">Prazo Entrega</th>
								<th scope="col">Obs</th>
								<th scope="col">Preço</th>
								<th scope="col">Total</th>
							</tr>
						</thead>
						<tbody id="linhaTableSerafinaEdicao">
							<div style="margin-bottom: 10px">
								<br>
								<button id="addItensSerafinaEdicao" type="submit" class="btn btn-outline-dark"
									onclick="mostraModalProdutosSerafina()">Adicionar Item</button>
								<br>
							</div>
						</tbody>
					</table>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-bs-dismiss="modal"
					onclick="limparLinhasEdicaoSerafina()">Fechar</button>
				<button type="button" class="btn btn-primary"
					onclick="atualizarItensBaseClicSerafina()">Atualizar</button>
				<button onclick="enviarWebServiceMaxiplastSerafina()" type="button" class="btn btn-success">Enviar</button>
			</div>
		</div>|
	</div>
</div>

<!-- MODAL EDIÇÃO PRODUTOS SERAFINA -->
<form id="formProdutoSerafinaEdicao">
	<div id="modalSelectTipoItemSerafinaEdicao" class="modal fade" data-bs-backdrop="static">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Selecione a Opção</h5>
				</div>
				<div class="modal-body">
					<label for="inputProdutoSerafinaEdicao" class="form-label">Produto</label>
					<input class="form-control" type="text" list="produtosSerafina" id="inputProdutoSerafinaEdicao"
						disabled />
					<datalist id="produtosSerafina"></datalist>
					<br>
					<div class="container">
						<div class="row ">
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioSerafinaEdicao" type="radio"
									id="inputBrancoSerafinaEdicao" value="Novo Produto - Branco"
									onclick="disableInputSerafinaEdicao()" required>
								<label class="form-check-label" for="inputBrancoSerafinaEdicao">Novo Produto -
									Branco</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioSerafinaEdicao" type="radio"
									id="inputCopiaSerafinaEdicao" value="Novo Produto - Copiar"
									onclick="enableInputSerafinaEdicao()" required>
								<label class="form-check-label" for="inputCopiaSerafinaEdicao">Novo Produto -
									Copiar</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioSerafinaEdicao" type="radio"
									id="inputExistenteSerafinaEdicao" value="Produto já existente"
									onclick="enableInputSerafinaEdicao()" required>
								<label class="form-check-label" for="inputExistenteSerafinaEdicao">Produto já
									existente</label>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button id="cancelModalProdutoSerafinaEdicao" type="button"
						class="btn btn-secondary">Cancelar</button>
					<button id="confirmModalProdutoSerafinaEdicao" type="submit" class="btn btn-primary"
						onclick="addLinhasSerafinaEdicao()">Confirmar</button>
				</div>
			</div>
		</div>
	</div>
</form>

<!-- MODAL EDIÇÃO Matriz-->
<div id="modalEdicaoMatriz" class="modal" tabindex="-1">
	<div class="modal-dialog modal-fullscreen">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Edição Orçamento</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div id="corpoModalEdicaoMatriz" class="modal-body">
				<div style="overflow-x: scroll">
					<table id="tableEdicaoMatriz" class="table table-bordered border-dark" style="font-size: small">
						<thead>
							<tr style="text-align: center;vertical-align: middle;">
								<th scope="col"></th>
								<th scope="col">Item</th>
								<th scope="col">Largura(cm)</th>
								<th scope="col">Altura(cm)</th>
								<th scope="col">Espessura(mm)</th>
								<th scope="col">Unid. Medida</th>
								<th scope="col">Quantidade</th>
								<th scope="col">Tipo Embalagem</th>
								<th scope="col">Monocamada / Laminado / Bilaminado</th>
								<th scope="col">Tipo Material</th>
								<th scope="col">Pigmentado / Transparente</th>
								<th scope="col">Liso / Impresso</th>
								<th scope="col">Quantidade Cores</th>
								<th scope="col">Tipo de Solda</th>
								<th scope="col">Prazo Entrega</th>
								<th scope="col">Obs</th>
								<th scope="col">Preço</th>
								<th scope="col">Total</th>
							</tr>
						</thead>
						<tbody id="linhaTableMatrizEdicao">
							<div style="margin-bottom: 10px">
								<br>
								<button id="addItensMatrizEdicao" type="submit" class="btn btn-outline-dark"
									onclick="mostraModalProdutosMatriz()">Adicionar Item</button>
								<br>
							</div>
						</tbody>
					</table>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-bs-dismiss="modal"
					onclick="limparLinhasEdicaoMatriz()">Fechar</button>
				<button type="button" class="btn btn-primary"
					onclick="atualizarItensBaseClicMatriz()">Atualizar</button>
				<button type="button" class="btn btn-success"
					onclick="enviarWebServiceMaxiplastMatriz()">Enviar</button>
			</div>
		</div>|
	</div>
</div>

<!-- MODAL EDIÇÃO PRODUTOS Matriz -->
<form id="formProdutoMatrizEdicao">
	<div id="modalSelectTipoItemMatrizEdicao" class="modal fade" data-bs-backdrop="static">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Selecione a Opção</h5>
				</div>
				<div class="modal-body">
					<label for="inputProdutoMatrizEdicao" class="form-label">Produto</label>
					<input class="form-control" type="text" list="produtosMatriz" id="inputProdutoMatrizEdicao"
						disabled />
					<datalist id="produtosMatriz"></datalist>
					<br>
					<div class="container">
						<div class="row ">
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioMatrizEdicao" type="radio"
									id="inputBrancoMatrizEdicao" value="Novo Produto - Branco"
									onclick="disableInputMatrizEdicao()" required>
								<label class="form-check-label" for="inputBrancoMatrizEdicao">Novo Produto -
									Branco</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioMatrizEdicao" type="radio"
									id="inputCopiaMatrizEdicao" value="Novo Produto - Copiar"
									onclick="enableInputMatrizEdicao()" required>
								<label class="form-check-label" for="inputCopiaMatrizEdicao">Novo Produto -
									Copiar</label>
							</div>
							<div class="form-check col">
								<input class="form-check-input" name="flexRadioMatrizEdicao" type="radio"
									id="inputExistenteMatrizEdicao" value="Produto já existente"
									onclick="enableInputMatrizEdicao()" required>
								<label class="form-check-label" for="inputExistenteMatrizEdicao">Produto já
									existente</label>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button id="cancelModalProdutoMatrizEdicao" type="button"
						class="btn btn-secondary">Cancelar</button>
					<button id="confirmModalProdutoMatrizEdicao" type="submit" class="btn btn-primary"
						onclick="addLinhasMatrizEdicao()">Confirmar</button>
				</div>
			</div>
		</div>
	</div>
</form>

</html>

<!--          						S C R I P T S - LOAD           						-->
<script>
	var linhasRafia = [];
	var linhasRafiaEdicao;
	var linhasTableRafiaEdicao = "";
	var jsonFormatado;
	var linhaOrcamentosClic = "";
	var orcamentosClicJson = [];
	var clienteSel;
	var orcamentoSel;
	var vendedorSel;
	var idSel;
	var linhasSerafina = [];
	var linhasSerafinaEdicao;
	var linhasTableSerafinaEdicao = "";
	var linhasMatriz = [];
	var linhasMatrizEdicao;
	var linhasTableMatrizEdicao = "";

	var options;

	window.addEventListener("load", function preencheVendedorRafia() {
		var vendedor = parent.dadosUserLogadoPersonalizado().rNome;
		var vendedorId = parent.dadosUserLogadoPersonalizado().rId;

		let optionVendedor = document.createElement('option');
		optionVendedor.innerHTML = vendedorId + "&nbsp-&nbsp " + vendedor;
		document.getElementById('selectVendedor').appendChild(optionVendedor);

	}, false);

	window.addEventListener("load", function preencheVendedorSerafina() {
		var vendedor = parent.dadosUserLogadoPersonalizado().rNome;
		var vendedorId = parent.dadosUserLogadoPersonalizado().rId;

		let optionVendedor = document.createElement('option');
		optionVendedor.innerHTML = vendedorId + "&nbsp-&nbsp " + vendedor;
		document.getElementById('selectVendedorSerafina').appendChild(optionVendedor);

	}, false);

	window.addEventListener("load", function preencheVendedorMatriz() {
		var vendedor = parent.dadosUserLogadoPersonalizado().rNome;
		var vendedorId = parent.dadosUserLogadoPersonalizado().rId;

		let optionVendedor = document.createElement('option');
		optionVendedor.innerHTML = vendedorId + "&nbsp-&nbsp " + vendedor;
		document.getElementById('selectVendedorMatriz').appendChild(optionVendedor);

	}, false);

	window.addEventListener("load", function listaItensBaseClic() {
		var parametros = {
			"param": {
				"idCvTccnpj": parent.dadosUserLogado().cId
			},
			"filter": {
				"customFilter": [
				]
			}
		};
		$.ajax({
			url: 'https://maxiplast.clicvenda.com.br/clicVendas/rest/pedidov2/lista',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var array = response.data;
				array.map(({ id, jsonDocs, dataAlteracao }) => {
					var dataAlteracao = new Date();
					dataAlteracao = dataAlteracao.toLocaleDateString();
					var json = JSON.parse(jsonDocs);
					orcamentosClicJson.push({ id, ...json });
					if (json.situacao === "CANCELADO" || json.situacao === "EM ORÇAMENTO") {
						linhaOrcamentosClic += `<tr style="text-align: center">
											 <th class="col-md-1" style="font-weight: 400;" scope="row">${id}</th>
											 <td class="col-md-1">${json.situacao}</td>
											 <td class="col-md-2">${json.numOrcamentoERP}</td>
											 <td class="col-md-1">${json.numPedidoERP}</td>
											 <td class="col-md-1">${json.unidade}</td>
											 <td class="col-md-2">${json.cliente}</td>
											 <td class="col-md-1">${dataAlteracao}</td>
											 <td class="col-md-2">${json.vendedor}</td>
											 <td style="font-size: 18px"></td>
											</tr>`;
					}
					else {
						linhaOrcamentosClic += `<tr style="text-align: center">
											 <th class="col-md-1" style="font-weight: 400;" scope="row">${id}</th>
											 <td class="col-md-1">${json.situacao}</td>
											 <td class="col-md-2">${json.numOrcamentoERP}</td>
											 <td class="col-md-1">${json.numPedidoERP}</td>
											 <td class="col-md-1">${json.unidade}</td>
											 <td class="col-md-2">${json.cliente}</td>
											 <td class="col-md-1">${dataAlteracao}</td>
											 <td class="col-md-2">${json.vendedor}</td>
											 <td style="font-size: 18px">
												<span id="editar${id}" type="button" title="Editar" >
													<i class="bi bi-pencil-square" style="color: grey" onclick="abrirModalEdicao(${id}, '${json.unidade}')"></i>
												</span>
												<span id="excluir${id}" type="button" title="Excluir">
													<i class="bi bi-trash" style="color: red" onclick="cancelaOrcamentoBaseClic(${id}, '${json.unidade}')"></i>
												</span>
											 </td>
											</tr>`;
					}
				});
				document.getElementById("tbodyOrcamentosClic").innerHTML = linhaOrcamentosClic;
			}
		});
	}, false);

	window.addEventListener("load", function filtroClientes() {
		var clientesExistentesHTML = "";
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaClienteMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				objRetorno.map(({ id, nome }) => clientesExistentesHTML += `<option id="${id}" name="clientes">${nome}</option>`);
				document.getElementById("clientes").innerHTML = clientesExistentesHTML;
			},
			beforeSend: function () {
				$("#loadingModal").modal({ backdrop: 'static', keyboard: false });
			},
			complete: function () {
				$("#loadingModal").modal('hide');
			},
			error: function (response) {
				alert(response);
			}
		});
	}, false);

	window.addEventListener("load", function listarProdutosRafia() {
		var produtosExistentesHTML = "";
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				objRetorno.map(({ id, item }) => produtosExistentesHTML += `<option id="${id}" name="produtos">${item}</option>`);
				document.getElementById("produtos").innerHTML = produtosExistentesHTML;
			},
			beforeSend: function () {
				$("#loadingModal").modal({ backdrop: 'static', keyboard: false });
			},
			complete: function () {
				$("#loadingModal").modal('hide');
			},
			error: function (response) {
				alert(response);
			}
		});
	}, false);

	window.addEventListener("load", function listarProdutosSerafina() {
		var produtosExistentesHTML = "";
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				objRetorno.map(({ id, item }) =>

					produtosExistentesHTML += `<option id="${id}" name="produtosSerafina">${item}</option>`);
				document.getElementById("produtosSerafina").innerHTML = produtosExistentesHTML;

			}
		});


	}, false);

	window.addEventListener("load", function listarProdutosMatriz() {
		var produtosExistentesHTML = "";
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				objRetorno.map(({ id, item }) => produtosExistentesHTML += `<option id="${id}" name="produtosMatriz">${item}</option>`);
				document.getElementById("produtosMatriz").innerHTML = produtosExistentesHTML;
			}
		});
	}, false);

	$("#abreModal").click(function () {
		$("#modalSelectUnidade").modal('show');
	});

	$("#botaoSelUnidade").click(function () {
		if (document.getElementById("unidadeSelecionada").value == "Rafia") {
			$("#modalSelectUnidade").modal('hide');
			$("#orcamentoRafia").modal('show');
		} else if (document.getElementById("unidadeSelecionada").value == "Serafina") {
			$("#modalSelectUnidade").modal('hide');
			$("#orcamentoSerafina").modal('show');
		} else {
			$("#modalSelectUnidade").modal('hide');
			$("#orcamentoMatriz").modal('show');
		}
	});

	function abrirModalEdicao(_id, _unidade) {
		idSel = _id;
		var orcamento = orcamentosClicJson.find(({ id }) => id == _id);

		if (_unidade == "Rafia") {
			linhasRafiaEdicao = [...orcamento.itens];
			linhasRafiaEdicao.map((item) => {
				if (!item.numOrc) {
					item.numOrc = idSel.toString();
				};
			});
		}
		else if (_unidade == "Serafina") {
			linhasSerafinaEdicao = [...orcamento.itens];
			linhasSerafinaEdicao.map((item) => {
				if (!item.numOrc) {
					item.numOrc = idSel.toString();
				};
			});
		}
		else if (_unidade == "Matriz") {
			linhasMatrizEdicao = [...orcamento.itens];
			linhasMatrizEdicao.map((item) => {
				if (!item.numOrc) {
					item.numOrc = idSel.toString();
				};
			});
		}
		clienteSel = orcamento.cliente;
		orcamentoSel = orcamento.orcamento;
		vendedorSel = orcamento.vendedor;

		if (_unidade == "Rafia") {
			var index;
			orcamento.itens.map((prod, indice) => {
				index = indice;
				linhasTableRafiaEdicao += `
								<tr id="${indice}" style="text-align: center;vertical-align: middle;">
								<th scope="row">
								<span type="button">
								<i class="bi bi-x-square-fill" style="color: red" onclick="removerElementoEdicao(event.target, ${indice})"></i>
								</span>
								</th>
								<td><input ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.item}" onkeyup="escreverValorEdicao('item',${indice},this.value)"></input></td>
								<td><input ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.unidMed}" onkeyup="escreverValorEdicao('unidMed',${indice},this.value)"></input></td>
								<td><input type="number" value="${prod.quantidade}" onkeyup="escreverValorEdicao('quantidade',${indice},this.value)"></input></td>
								<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.preco}" onkeyup="escreverValorEdicao('preco',${indice},this.value)"></input></td>
								<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.total}" onkeyup="escreverValorEdicao('total',${indice},this.value)"></input></td>
								<td>
									<select ${prod.tipoItem === "Existente" && "disabled"} id="tipoEmbalagemRafiaEdicao${indice}" onchange="escreverValorEdicao('tipoEmbalagem',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.tipoEmbalagem}"</option>
									</select>
								</td>
								<td >
									<select ${prod.tipoItem === "Existente" && "disabled"} id="tipoLaminadoRafiaEdicao${indice}" onchange="escreverValorEdicao('tipoLaminado',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.tipoLaminado}"</option>
									</select>
								</td>
								<td >
									<select ${prod.tipoItem === "Existente" && "disabled"} id="pigmentadoTransparenteRafiaEdicao${indice}" onchange="escreverValorEdicao('pigmentadoTransparente',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.pigmentadoTransparente}"</option>
									</select>
								</td>
								<td>
									<select ${prod.tipoItem === "Existente" && "disabled"} id="lisoImpressoRafiaEdicao${indice}" onchange="escreverValorEdicao('lisoImpresso',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.lisoImpresso}"</option>
									</select>
								</td>
								<td >
									<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicao('qtdCoresFrente',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.qtdCoresFrente}"</option>
										<option value="1">1</option>
										<option value="2">2</option>
										<option value="3">3</option>
										<option value="4">4</option>
										<option value="5">5</option>
										<option value="6">6</option>
										<option value="7">7</option>
										<option value="8">8</option>
									</select>
								</td>
								<td >
									<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicao('qtdCoresVerso',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.qtdCoresVerso}"</option>
									<option value="1">1</option>
									<option value="2">2</option>
									<option value="3">3</option>
									<option value="4">4</option>
									<option value="5">5</option>
									<option value="6">6</option>
									<option value="7">7</option>
									<option value="8">8</option>
									</select>
								</td>
								<td >
									<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicao('gramaturaLaminado',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.gramaturaLaminado}"</option>
									<option value="1">59</option>
									<option value="2">63</option>
									<option value="3">66</option>
									<option value="4">69</option>
									<option value="5">72</option>
									</select>
								</td>
								<td >
									<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicao('gramaturaConvencional',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.gramaturaConvencional}"</option>
									<option value="1">54</option>
									<option value="2">58</option>
									<option value="3">62</option>
									</select>
								</td>
								<td><input ${prod.tipoItem === "Existente" && "disabled"} value="${prod.corTrama}" onkeyup="escreverValorEdicao('corTrama',${indice},this.value)"></input></td>
								<td><input ${prod.tipoItem === "Existente" && "disabled"} value="${prod.corUrdume}" onkeyup="escreverValorEdicao('corUrdume',${indice},this.value)"></input></td>
								<td>
									<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicao('sanfona',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.sanfona}"</option>
									<option value="1">S</option>
									<option value="2">N</option>
									</select>
								</td>
								<td >
									<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicao('medidaSanfona',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.medidaSanfona}"</option>
									<option value="1">5</option>
									<option value="2">6</option>
									<option value="3">7</option>
									<option value="4">8</option>
									</select>
								</td>
								<td>
									<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicao('valvula',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.valvula}"</option>
									<option value="1">S</option>
									<option value="2">N</option>
									</select>
								</td>
								<td >
									<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicao('medidaValvula',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.medidaValvula}"</option>
									<option value="1">5</option>
									<option value="2">6</option>
									<option value="3">7</option>
									<option value="4">8</option>
									</select>
								</td>
								<td>
									<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicao('lyner',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.lyner}"</option>
									<option value="1">S</option>
									<option value="2">N</option>
									</select>
								</td>
								<td><input ${prod.tipoItem === "Existente" && "disabled"} type="number" value="${prod.largura}" onkeyup="escreverValorEdicao('largura',${indice},this.value)"></input></td>
								<td><input ${prod.tipoItem === "Existente" && "disabled"} type="number" value="${prod.comprimento}" onkeyup="escreverValorEdicao('comprimento',${indice},this.value)" ></input></td>
								<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.estadoDestino}" onkeyup="escreverValorEdicao('estadoDestino',${indice},this.value)"></input></td>
								<td><input ${prod.tipoItem === "Existente" && "disabled"} type="number" value="${prod.gramatura}" onkeyup="escreverValorEdicao('gramatura',${indice},this.value)"></input></td>
							</tr>`;
			}).join("");
			document.getElementById("linhaTableRafiaEdicao").innerHTML = linhasTableRafiaEdicao;
			listaTipoEmbalagemRafiaEdicao(index);
			listaTipoLaminadoRafiaEdicao(index);
			listaPigmentosRafiaEdicao(index);
			lisoImpressoRafiaEdicao(index);
			$("#modalEdicao").modal('show');
		}
		else if (_unidade == "Serafina") {

			var index;
			orcamento.itens.map((prod, indice) => {
				index = indice;
				linhasTableSerafinaEdicao += `<tr id="${indice}" style="text-align: center;vertical-align: middle;">
					<th scope="row">
						<span type="button">
						<i class="bi bi-x-square-fill" style="color: red" onclick="removerElementoSerafinaEdicao(event.target, ${indice})"></i>
						</span>
					</th>
					<td><input ${prod.tipoItem != "Branco" && "disabled"} value= "${prod.item}" onkeyup="escreverValorEdicaoSerafina('item',${indice},this.value)"></input></td>
					<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.largura}" onkeyup="escreverValorEdicaoSerafina('largura',${indice},this.value)"></input></td>
					<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.altura}" onkeyup="escreverValorEdicaoSerafina('altura',${indice},this.value)"></input></td>
					<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.espessura}" onkeyup="escreverValorEdicaoSerafina('espessura',${indice},this.value)"></input></td>
					<td><input ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.unidMed}" onkeyup="escreverValorEdicaoSerafina('unidMed',${indice},this.value)"></input></td>
					<td><input type="number" value= "${prod.quantidade}" onkeyup="escreverValorEdicaoSerafina('quantidade',${indice},this.value)"></input></td>
					<td>
						<select id="tipoEmbalagemSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('tipoEmbalagem',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.tipoEmbalagem}"</option>
						</select>
					</td>
					<td>
						<select id="tipoLaminadoSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('tipoLaminado',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.tipoLaminado}"</option>
						</select>
					</td>
					<td>
						<select id="tipoMaterialSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('tipoMaterial',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.tipoMaterial}"</option>
						</select>
					</td>
					<td>
						<select id="pigmentadoTransparenteSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('pigmentadoTransparente',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.pigmentadoTransparente}"</option>
						</select>
					</td>
					<td>
						<select id="lisoImpressoSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('lisoImpresso',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.lisoImpresso}"</option>
						</select>
					</td>
					<td>
						<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('qtdCores',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.qtdCores}"</option>
									<option value="1">1</option>
									<option value="2">2</option>
									<option value="3">3</option>
									<option value="4">4</option>
									<option value="5">5</option>
									<option value="6">6</option>
									<option value="7">7</option>
									<option value="8">8</option>
						</select>
					</td>
					<td>
						<select id="tipoSoldaSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('tipoSolda',${indice},this.options[this.selectedIndex].text)">
							<option selected disabled>${prod.tipoSolda}</option>
						</select>
					</td>
					<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.prazoEntrega}" onkeyup="escreverValorEdicaoSerafina('prazoEntrega',${indice},this.value)"></td>
					<td><input value= "${prod.obs}" onkeyup="escreverValorEdicaoSerafina('obs',${indice},this.value)"></td>
					<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorEdicaoSerafina('preco',${indice},this.value)"></td>
					<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorEdicaoSerafina('total',${indice},this.value)"></td>
				</tr>`;
			}).join("");
			document.getElementById("linhaTableSerafinaEdicao").innerHTML = linhasTableSerafinaEdicao;
			listaTipoEmbalagemFlexivelEdicao(index);
			listaTipoLaminadoFlexivelEdicao(index);
			listaTipoMaterialFlexivelEdicao(index);
			listaPigmentosFlexivelEdicao(index);
			lisoImpressoFlexivelEdicao(index);
			listaTipoSoldaFlexivelEdicao(index);
			$("#modalEdicaoSerafina").modal('show');

		}
		else if (_unidade == "Matriz") {
			var index;
			orcamento.itens.map((prod, indice) => {
				index = indice;
				linhasTableMatrizEdicao += `<tr id="${indice}" style="text-align: center;vertical-align: middle;">
							<th scope="row">
								<span type="button">
								<i class="bi bi-x-square-fill" style="color: red" onclick="removerElementoMatrizEdicao(event.target, ${indice})"></i>
								</span>
							</th>
							<td><input ${prod.tipoItem != "Branco" && "disabled"} value= "${prod.item}" onkeyup="escreverValorEdicaoMatriz('item',${indice},this.value)"></input></td>
							<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.largura}" onkeyup="escreverValorEdicaoMatriz('largura',${indice},this.value)"></input></td>
							<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.altura}" onkeyup="escreverValorEdicaoMatriz('altura',${indice},this.value)"></input></td>
							<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.espessura}" onkeyup="escreverValorEdicaoMatriz('espessura',${indice},this.value)"></input></td>
							<td><input ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.unidMed}" onkeyup="escreverValorEdicaoMatriz('unidMed',${indice},this.value)"></input></td>
							<td><input type="number" value="${prod.quantidade}" onkeyup="escreverValorEdicaoMatriz('quantidade',${indice},this.value)"></input></td>
							<td>
								<select id="tipoEmbalagemMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('tipoEmbalagem',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.tipoEmbalagem}"</option>
								</select>
							</td>
							<td>
								<select id="tipoLaminadoMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('tipoLaminado',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.tipoLaminado}"</option>
								</select>
							</td>
							<td>
								<select id="tipoMaterialMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('tipoMaterial',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.tipoMaterial}"</option>
								</select>
							</td>
							<td>
								<select id="pigmentadoTransparenteMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('pigmentadoTransparente',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.pigmentadoTransparente}"</option>
								</select>
							</td>
							<td>
								<select id="lisoImpressoMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('lisoImpresso',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.lisoImpresso}"</option>
								</select>
							</td>
							<td>
								<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('qtdCores',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.qtdCores}"</option>
											<option value="1">1</option>
											<option value="2">2</option>
											<option value="3">3</option>
											<option value="4">4</option>
											<option value="5">5/option>
											<option value="6">6</option>
											<option value="7">7</option>
											<option value="8">8</option>
								</select>
							</td>
							<td>
								<select id="tipoSoldaMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('tipoSolda',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.tipoSolda}"</option>
								</select>
							</td>
							<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.prazoEntrega}" onkeyup="escreverValorEdicaoMatriz('prazoEntrega',${indice},this.value)"></td>
							<td><input value="${prod.obs}" onkeyup="escreverValorEdicaoMatriz('obs',${indice},this.value)"></td>
							<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorEdicaoMatriz('preco',${indice},this.value)"></td>
							<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorEdicaoMatriz('total',${indice},this.value)"></td>
						</tr>`
			}).join("");
			document.getElementById("linhaTableMatrizEdicao").innerHTML = linhasTableMatrizEdicao;
			listaTipoEmbalagemMatrizEdicao(index);
			listaTipoLaminadoMatrizEdicao(index);
			listaTipoMaterialMatrizEdicao(index);
			listaPigmentosMatrizEdicao(index);
			lisoImpressoMatrizEdicao(index);
			listaTipoSoldaMatrizEdicao(index);
			$("#modalEdicaoMatriz").modal('show');
		}
	}

	function cancelaOrcamentoBaseClic(_id, _unidade) {

		var listaOrcRafia;
		var listaOrcSerafina;
		var listaOrcMatriz;
		var jsonFormatadoAtualizado;

		var orcamento = orcamentosClicJson.find(({ id }) => id == _id);
		idSel = _id;

		if (_unidade == "Rafia") {
			listaOrcRafia = [...orcamento.itens];
			jsonFormatadoAtualizado = { "numOrcamentoERP": 0, "numPedidoERP": 0, "situacao": "CANCELADO", "unidade": orcamento.unidade, "cliente": orcamento.cliente, "vendedor": orcamento.vendedor, "itens": listaOrcRafia };
		}
		else if (_unidade == "Serafina") {
			listaOrcSerafina = [...orcamento.itens];
			jsonFormatadoAtualizado = { "numOrcamentoERP": 0, "numPedidoERP": 0, "situacao": "CANCELADO", "unidade": orcamento.unidade, "cliente": orcamento.cliente, "vendedor": orcamento.vendedor, "itens": listaOrcSerafina };
		}
		else if (_unidade == "Matriz") {
			listaOrcMatriz = [...orcamento.itens];
			jsonFormatadoAtualizado = { "numOrcamentoERP": 0, "numPedidoERP": 0, "situacao": "CANCELADO", "unidade": orcamento.unidade, "cliente": orcamento.cliente, "vendedor": orcamento.vendedor, "itens": listaOrcMatriz };
		}

		var parametros = {
			"cnpj": {
				"id": parent.dadosUserLogado().cId
			},
			"jsonDocs": JSON.stringify(jsonFormatadoAtualizado)
		};
		$.ajax({
			url: 'https://maxiplast.clicvenda.com.br/clicVendas/rest/pedidov2/salvar/' + idSel,
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				document.location.reload();
			}
		});
	}

	function enviarOrcSucesso(_id, _unidade) {

		var jsonFormatadoAtualizado;

		var orcamento = orcamentosClicJson.find(({ id }) => id == _id);
		idSel = _id;

		if (_unidade == "Matriz") {
			var listaOrcMatriz = [...orcamento.itens];
			jsonFormatadoAtualizado = { "numOrcamentoERP": 0, "numPedidoERP": 0, "situacao": "EM ORÇAMENTO", "unidade": orcamento.unidade, "cliente": orcamento.cliente, "vendedor": orcamento.vendedor, "itens": listaOrcMatriz };
		}
		else if (_unidade == "Serafina") {
			var listaOrcSerafina = [...orcamento.itens];
			jsonFormatadoAtualizado = { "numOrcamentoERP": 0, "numPedidoERP": 0, "situacao": "EM ORÇAMENTO", "unidade": orcamento.unidade, "cliente": orcamento.cliente, "vendedor": orcamento.vendedor, "itens": listaOrcSerafina };
		}
		else if (_unidade == "Rafia") {
			var listaOrcRafia = [...orcamento.itens];
			console.log("listaOrcRafia", listaOrcRafia);
			jsonFormatadoAtualizado = { "numOrcamentoERP": 0, "numPedidoERP": 0, "situacao": "EM ORÇAMENTO", "unidade": orcamento.unidade, "cliente": orcamento.cliente, "vendedor": orcamento.vendedor, "itens": listaOrcRafia };
		}

		var parametros = {
			"cnpj": {
				"id": parent.dadosUserLogado().cId
			},
			"jsonDocs": JSON.stringify(jsonFormatadoAtualizado)
		};
		$.ajax({
			url: 'https://maxiplast.clicvenda.com.br/clicVendas/rest/pedidov2/salvar/' + idSel,
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				document.location.reload();
			}
		});
	}



</script>

<!--          						S C R I P T S  -  R A F I A  - EDICAO				-->
<script>
	function listaTipoEmbalagemRafiaEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoEmbalagemFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoEmbalagem.map((option) => {
					let optionsTipoEmb = document.createElement('option');
					optionsTipoEmb.innerHTML = option;

					document.getElementById('tipoEmbalagemRafiaEdicao' + idx).appendChild(optionsTipoEmb);
				});

			}
		});
	};
	function listaTipoLaminadoRafiaEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoLaminadoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoLaminado.map((option) => {
					let optionsTipoLam = document.createElement('option');
					optionsTipoLam.innerHTML = option;

					document.getElementById('tipoLaminadoRafiaEdicao' + idx).appendChild(optionsTipoLam);
				});
			}
		});
	};
	function listaPigmentosRafiaEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaPigmentosFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.pigmentadoTransparente.map((option) => {
					let optionsPigmentoTransp = document.createElement('option');
					optionsPigmentoTransp.innerHTML = option;

					document.getElementById('pigmentadoTransparenteRafiaEdicao' + idx).appendChild(optionsPigmentoTransp);
				});
			}
		});
	};
	function lisoImpressoRafiaEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "lisoImpressoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.lisoImpresso.map((option) => {
					let optionsLisoImpresso = document.createElement('option');
					optionsLisoImpresso.innerHTML = option;

					document.getElementById('lisoImpressoRafiaEdicao' + idx).appendChild(optionsLisoImpresso);
				});
			}
		});
	};
	function mostraModalProdutos() {
		$("#modalSelectTipoItemRafiaEdicao").modal('show');
	}
	function limparLinhasEdicao() {
		linhasTableRafiaEdicao = "";
	}
	$("#addItensRafiaEdicao").click(function () {
		$("#modalSelectTipoItemRafiaEdicao").modal('show');
		document.getElementById("modalSelectTipoItemRafiaEdicao").style.filter = "drop-shadow(2px 4px 6px black)";
		document.getElementById("modalEdicao").style.filter = "blur(2px)";
	});
	$("#cancelModalProdutoRafiaEdicao").click(function () {
		document.getElementById("modalSelectTipoItemRafiaEdicao").style.filter = "unset";
		document.getElementById("modalEdicao").style.filter = "unset";
		$("#modalSelectTipoItemRafiaEdicao").modal('hide');
	});
	function enableInputRafiaEdicao() {
		document.querySelector(`input[id="inputProdutoRafiaEdicao"]`).disabled = false;
	}
	function disableInputRafiaEdicao() {
		document.querySelector(`input[id="inputProdutoRafiaEdicao"]`).disabled = true;
	}
	function atualizarTabelaRafiaEdicao() {
		var index;

		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				document.querySelector('#linhaTableRafiaEdicao').innerHTML = linhasRafiaEdicao.map(function (prod, indice) {
					index = indice;
					return `<tr id="${indice}" style="text-align: center;vertical-align: middle;">
						<th scope="row">
						<span type="button">
						<i class="bi bi-x-square-fill" style="color: red" onclick="removerElemento(event.target, ${indice})"></i>
						</span>
						</th>
						<td><input type="text" ${prod.tipoItem != "Branco" && "disabled"} value= "${prod.item}" onkeyup="escreverValor('item',${indice},this.value)"></input></td>
						<td><input ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.unidMed}" onkeyup="escreverValor('unidMed',${indice},this.value)"></input></td>
						<td><input type="number" value="${prod.quantidade}" onkeyup="escreverValor('quantidade',${indice},this.value)"></input></td>
						<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.preco}" onkeyup="escreverValor('preco',${indice},this.value)"></input></td>
						<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.total}" onkeyup="escreverValor('total',${indice},this.value)"></input></td>
						<td>
							<select id="tipoEmbalagemRafiaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('tipoEmbalagem',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.tipoEmbalagem}"</option>
							</select>
						</td>
						<td >
							<select id="tipoLaminadoRafiaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('tipoLaminado',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.tipoLaminado}"</option>
							</select>
						</td>
						<td >
							<select id="pigmentadoTransparenteRafiaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('pigmentadoTransparente',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.pigmentadoTransparente}"</option>

							</select>
						</td>
						<td>
							<select id="lisoImpressoRafiaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('lisoImpresso',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.lisoImpresso}"</option>
							</select>
						</td>
						<td >
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('qtdCoresFrente',${indice},this.options[this.selectedIndex].text)">
								<option selected disabled>"${prod.qtdCoresFrente}"</option>
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5</option>
								<option value="6">6</option>
								<option value="7">7</option>
								option value="8">8</option>
							</select>
						</td>
						<td >
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('qtdCoresVerso',${indice},this.options[this.selectedIndex].text)">
								<option selected disabled>"${prod.qtdCoresVerso}"</option>
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5</option>
								<option value="6">6</option>
								<option value="7">7</option>
								option value="8">8</option>
							</select>
						</td>
						<td >
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('gramaturaLaminado',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.gramaturaLaminado}"</option>
							  <option value="1">59</option>
							  <option value="2">63</option>
							  <option value="3">66</option>
							  <option value="4">69</option>
							  <option value="5">72</option>
							</select>
						</td>
						<td >
							<select  ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('gramaturaConvencional',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.gramaturaConvencional}"</option>
							  <option value="1">54</option>
							  <option value="2">58</option>
							  <option value="3">62</option>
							</select>
						</td>
						<td><input ${prod.tipoItem === "Existente" && "disabled"} value="${prod.corTrama}" onkeyup="escreverValor('corTrama',${indice},this.value)"></input></td>
						<td><input ${prod.tipoItem === "Existente" && "disabled"} value="${prod.corUrdume}" onkeyup="escreverValor('corUrdume',${indice},this.value)"></input></td>
						<td>
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('sanfona',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.sanfona}"</option>
							  <option value="1">S</option>
							  <option value="2">N</option>
							</select>
						</td>
						<td >
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('medidaSanfona',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.medidaSanfona}"</option>
							  <option value="1">5</option>
							  <option value="2">6</option>
							  <option value="3">7</option>
							  <option value="4">8</option>
							 </select>
						</td>
						<td>
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('valvula',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.valvula}"</option>
							  <option value="1">S</option>
							  <option value="2">N</option>
							</select>
						</td>
						<td >
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('medidaValvula',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.medidaValvula}"</option>
							  <option value="1">5</option>
							  <option value="2">6</option>
							  <option value="3">7</option>
							  <option value="4">8</option>
							</select>
						</td>
						<td>
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('lyner',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.lyner}"</option>
							  <option value="1">S</option>
							  <option value="2">N</option>
							</select>
						</td>
						<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value="${prod.largura}" onkeyup="escreverValor('largura',${indice},this.value)"></input></td>
						<td><input type="number"${prod.tipoItem === "Existente" && "disabled"} value="${prod.comprimento}" onkeyup="escreverValor('comprimento',${indice},this.value)" ></input></td>
						<td><input ${prod.tipoItem === "Existente" && "disabled"} value="${prod.estadoDestino}" onkeyup="escreverValor('estadoDestino',${indice},this.value)"></input></td>
						<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value="${prod.gramatura}" onkeyup="escreverValor('gramatura',${indice},this.value)"></input></td>
					</tr>`;
				}).join("");
			},
			complete: function () {
				listaTipoEmbalagemRafiaEdicao(index);
				listaTipoLaminadoRafiaEdicao(index);
				listaPigmentosRafiaEdicao(index);
				lisoImpressoRafiaEdicao(index);
			}
		});
	}
	function addLinhasEdicao() {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				var produtoSel = document.getElementById("inputProdutoRafiaEdicao").value;
				var checkBox = document.querySelector(`input[name="flexRadioRafiaEdicao"]:checked`).value;
				if (checkBox == "Novo Produto - Branco") {
					linhasRafiaEdicao.push({ "empresa": "1", "tipoItem": "Branco", "id": "", "item": "", "unidMed": "", "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": " ", "tipoLaminado": "", "pigmentadoTransparente": "", "lisoImpresso": "", "qtdCoresFrente": "", "qtdCoresVerso": "", "tipoSolda": "", "largura": "", "comprimento": "", "espessura": "", "gramaturaLaminado": "", "gramaturaConvencional": "", "sanfona": "", "medidaSanfona": "", "valvula": "", "medidaValvula": "", "estadoDestino": "", "gramatura": "", "corTrama": "", "corUrdume": "", "lyner": "" });
				}
				else if (checkBox == "Novo Produto - Copiar") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasRafiaEdicao.push({ "empresa": "1", "tipoItem": "Copiar", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": prod[0].quantidade, "preco": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCoresFrente": prod[0].qtdCoresFrente, "qtdCoresVerso": prod[0].qtdCoresVerso, "gramaturaLaminado": prod[0].gramaturaLaminado, "gramaturaConvencional": prod[0].gramaturaConvencional, "sanfona": prod[0].sanfona, "medidaSanfona": prod[0].medidaSanfona, "valvula": prod[0].valvula, "medidaValvula": prod[0].medidaValvula, "estadoDestino": "", "gramatura": prod[0].gramatura, "corTrama": prod[0].corTrama, "corUrdume": prod[0].corUrdume, "lyner": prod[0].lyner, "largura": prod[0].largura, "comprimento": prod[0].comprimento });
				}
				else if (checkBox == "Produto já existente") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasRafiaEdicao.push({ "empresa": "1", "tipoItem": "Existente", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": prod[0].quantidade, "preco": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCoresFrente": prod[0].qtdCoresFrente, "qtdCoresVerso": prod[0].qtdCoresVerso, "gramaturaLaminado": prod[0].gramaturaLaminado, "gramaturaConvencional": prod[0].gramaturaConvencional, "sanfona": prod[0].sanfona, "medidaSanfona": prod[0].medidaSanfona, "valvula": prod[0].valvula, "medidaValvula": prod[0].medidaValvula, "estadoDestino": "", "gramatura": prod[0].gramatura, "corTrama": prod[0].corTrama, "corUrdume": prod[0].corUrdume, "lyner": prod[0].lyner, "largura": prod[0].largura, "comprimento": prod[0].comprimento });
				}
				atualizarTabelaRafiaEdicao();
			}
		});
	}
	$("#confirmModalProdutoRafiaEdicao").click(function () {
		var formulario = document.getElementById("formProdutoRafiaEdicao");
		if (!formulario.checkValidity()) {
		}
		else {
			formulario.addEventListener('submit', function (e) {
				e.preventDefault();
			});
			var checkbox = document.querySelector(`input[name="flexRadioRafiaEdicao"]:checked`).value;
			if (checkbox == "Novo Produto - Copiar" || checkbox == "Produto já existente") {
				document.querySelector(`input[id="inputProdutoRafiaEdicao"]`).required = true;
				if (!formulario.checkValidity()) {
				}
				else {
					document.getElementById("modalSelectTipoItemRafiaEdicao").style.filter = "unset";
					document.getElementById("modalEdicao").style.filter = "unset";
					$("#modalSelectTipoItemRafiaEdicao").modal('hide');
				}
			}
			else {
				document.getElementById("formProdutoRafiaEdicao").style.filter = "unset";
				document.getElementById("modalEdicao").style.filter = "unset";
				$("#modalSelectTipoItemRafiaEdicao").modal('hide');
			}
		}
	});
	function escreverValorEdicao(prop, i, value) {
		var item = linhasRafiaEdicao[i];
		item[prop] = value;
	}
	function removerElementoEdicao(elementoClicado, i) {
		linhasRafiaEdicao.splice(i, 1);
		atualizarTabelaRafiaEdicao();
	}
	function montaJsonRafiaEdicao() {
		jsonFormatado = { "numOrcamentoERP": 0, "numPedidoERP": 0, "situacao": "EM EDIÇÃO", "unidade": "Rafia", "cliente": clienteSel, "orcamento": orcamentoSel, "vendedor": vendedorSel, "itens": linhasRafiaEdicao };
	}
	function atualizarItensBaseClicRafia() {
		montaJsonRafiaEdicao();
		var parametros = {
			"cnpj": {
				"id": parent.dadosUserLogado().cId
			},
			"jsonDocs": JSON.stringify(jsonFormatado)
		};
		$.ajax({
			url: 'https://maxiplast.clicvenda.com.br/clicVendas/rest/pedidov2/salvar/' + idSel,
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				$("#modalEdicao").modal('hide');
				$('#formRafia').each(function () {
					this.reset();
				});
				linhasRafiaEdicao = [];
				atualizarTabelaRafiaEdicao();
				document.location.reload();
			}
		});
	}

		
	function enviarWebServiceMaxiplastRafia() {

		montaJsonRafiaEdicao();

		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 996,
			pRotina: "enviarOrcRafia",
			pItem: jsonFormatado
		};


		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				enviarOrcSucesso(jsonFormatado.numOrcamentoERP, jsonFormatado.unidade);
			},
			beforeSend: function () {

			},
			complete: function () {

			},
			error: function () {

			}
		});
	}
</script>

<!--          						S C R I P T S  -  R A F I A           				-->
<script>
	function listaTipoEmbalagemRafia(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoEmbalagemFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoEmbalagem.map((option) => {
					let optionsTipoEmb = document.createElement('option');
					optionsTipoEmb.innerHTML = option;

					document.getElementById('tipoEmbalagemRafia' + idx).appendChild(optionsTipoEmb);
				});

			}
		});
	};
	function listaTipoLaminadoRafia(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoLaminadoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoLaminado.map((option) => {
					let optionsTipoLam = document.createElement('option');
					optionsTipoLam.innerHTML = option;

					document.getElementById('tipoLaminadoRafia' + idx).appendChild(optionsTipoLam);
				});
			}
		});
	};
	function listaPigmentosRafia(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaPigmentosFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.pigmentadoTransparente.map((option) => {
					let optionsPigmentoTransp = document.createElement('option');
					optionsPigmentoTransp.innerHTML = option;

					document.getElementById('pigmentadoTransparenteRafia' + idx).appendChild(optionsPigmentoTransp);
				});
			}
		});
	};
	function lisoImpressoRafia(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "lisoImpressoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.lisoImpresso.map((option) => {
					let optionsLisoImpresso = document.createElement('option');
					optionsLisoImpresso.innerHTML = option;

					document.getElementById('lisoImpressoRafia' + idx).appendChild(optionsLisoImpresso);
				});
			}
		});
	};
	$("#addItensRafia").click(function () {
		var formulario = document.getElementById("formRafia");
		if (!formulario.checkValidity()) {
		}
		else {
			formulario.addEventListener('submit', function (e) {
				e.preventDefault();
			});
			$("#modalSelectTipoItemRafia").modal('show');
			document.getElementById("modalSelectTipoItemRafia").style.filter = "drop-shadow(2px 4px 6px black)";
			document.getElementById("orcamentoRafia").style.filter = "blur(2px)";
		}
	});
	$("#cancelModalProdutoRafia").click(function () {
		document.getElementById("modalSelectTipoItemRafia").style.filter = "unset";
		document.getElementById("orcamentoRafia").style.filter = "unset";
		$("#modalSelectTipoItemRafia").modal('hide');
	});
	function enableInputRafia() {
		document.querySelector(`input[id="inputProdutoRafia"]`).disabled = false;
	}
	function disableInputRafia() {
		document.querySelector(`input[id="inputProdutoRafia"]`).disabled = true;
	}
	function escreverValor(prop, i, value) {
		var item = linhasRafia[i];
		item[prop] = value;
	}
	function atualizarTabelaRafia() {

		var index;

		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				document.querySelector('#linhaTableRafia').innerHTML = linhasRafia.map(function (prod, indice) {
					index = indice;
					return `<tr id="${indice}" style="text-align: center;vertical-align: middle;">
						<th scope="row">
						<span type="button">
						<i class="bi bi-x-square-fill" style="color: red" onclick="removerElemento(event.target, ${indice})"></i>
						</span>
						</th>
						<td><input type="text" ${prod.tipoItem != "Branco" && "disabled"} value= "${prod.item}" onkeyup="escreverValor('item',${indice},this.value)"></input></td>
						<td><input ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.unidMed}" onkeyup="escreverValor('unidMed',${indice},this.value)"></input></td>
						<td><input type="number" value="${prod.quantidade}" onkeyup="escreverValor('quantidade',${indice},this.value)"></input></td>
						<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.preco}" onkeyup="escreverValor('preco',${indice},this.value)"></input></td>
						<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.total}" onkeyup="escreverValor('total',${indice},this.value)"></input></td>
						<td>
							<select id="tipoEmbalagemRafia${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('tipoEmbalagem',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.tipoEmbalagem}"</option>
							</select>
						</td>
						<td >
							<select id="tipoLaminadoRafia${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('tipoLaminado',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.tipoLaminado}"</option>
							</select>
						</td>
						<td >
							<select id="pigmentadoTransparenteRafia${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('pigmentadoTransparente',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.pigmentadoTransparente}"</option>

							</select>
						</td>
						<td>
							<select id="lisoImpressoRafia${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('lisoImpresso',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.lisoImpresso}"</option>
							</select>
						</td>
						<td >
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('qtdCoresFrente',${indice},this.options[this.selectedIndex].text)">
								<option selected disabled>"${prod.qtdCoresFrente}"</option>
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5</option>
								<option value="6">6</option>
								<option value="7">7</option>
								<option value="8">8</option>
							</select>
						</td>
						<td >
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('qtdCoresVerso',${indice},this.options[this.selectedIndex].text)">
							 <option selected disabled>"${prod.qtdCoresVerso}"</option>
							 <option value="1">1</option>
							 <option value="2">2</option>
							 <option value="3">3</option>
							 <option value="4">4</option>
							 <option value="5">5</option>
							 <option value="6">6</option>
							 <option value="7">7</option>
							 <option value="8">8</option>
							</select>
						</td>
						<td >
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('gramaturaLaminado',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.gramaturaLaminado}"</option>
							  <option value="1">59</option>
							  <option value="2">63</option>
							  <option value="3">66</option>
							  <option value="4">69</option>
							  <option value="5">72</option>
							</select>
						</td>
						<td >
							<select  ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('gramaturaConvencional',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.gramaturaConvencional}"</option>
							  <option value="1">54</option>
							  <option value="2">58</option>
							  <option value="3">62</option>
							</select>
						</td>
						<td><input ${prod.tipoItem === "Existente" && "disabled"} value="${prod.corTrama}" onkeyup="escreverValor('corTrama',${indice},this.value)"></input></td>
						<td><input ${prod.tipoItem === "Existente" && "disabled"} value="${prod.corUrdume}" onkeyup="escreverValor('corUrdume',${indice},this.value)"></input></td>
						<td>
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('sanfona',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.sanfona}"</option>
							  <option value="1">S</option>
							  <option value="2">N</option>
							</select>
						</td>
						<td >
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('medidaSanfona',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.medidaSanfona}"</option>
							  <option value="1">5</option>
							  <option value="2">6</option>
							  <option value="3">7</option>
							  <option value="4">8</option>
							 </select>
						</td>
						<td>
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('valvula',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.valvula}"</option>
							  <option value="1">S</option>
							  <option value="2">N</option>
							</select>
						</td>
						<td >
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('medidaValvula',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.medidaValvula}"</option>
							  <option value="1">5</option>
							  <option value="2">6</option>
							  <option value="3">7</option>
							  <option value="4">8</option>
							</select>
						</td>
						<td>
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValor('lyner',${indice},this.options[this.selectedIndex].text)">
							  <option selected disabled>"${prod.lyner}"</option>
							  <option value="1">S</option>
							  <option value="2">N</option>
							</select>
						</td>
						<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value="${prod.largura}" onkeyup="escreverValor('largura',${indice},this.value)"></input></td>
						<td><input type="number"${prod.tipoItem === "Existente" && "disabled"} value="${prod.comprimento}" onkeyup="escreverValor('comprimento',${indice},this.value)" ></input></td>
						<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.estadoDestino}" onkeyup="escreverValor('estadoDestino',${indice},this.value)"></input></td>
						<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value="${prod.gramatura}" onkeyup="escreverValor('gramatura',${indice},this.value)"></input></td>
					</tr>`;
				}).join("");
			},
			complete: function () {
				listaTipoEmbalagemRafia(index);
				listaTipoLaminadoRafia(index);
				listaPigmentosRafia(index);
				lisoImpressoRafia(index);
			}
		});
	}
	function addLinhas() {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				var produtoSel = document.getElementById("inputProdutoRafia").value;
				var checkBox = document.querySelector(`input[name="flexRadioRafia"]:checked`).value;
				if (checkBox == "Novo Produto - Branco") {
					linhasRafia.push({ "empresa": "1", "tipoItem": "Branco", "id": "", "item": "", "unidMed": "", "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": " ", "tipoLaminado": "", "pigmentadoTransparente": "", "lisoImpresso": "", "qtdCoresFrente": "", "qtdCoresVerso": "", "tipoSolda": "", "largura": "", "comprimento": "", "espessura": "", "gramaturaLaminado": "", "gramaturaConvencional": "", "sanfona": "", "medidaSanfona": "", "valvula": "", "medidaValvula": "", "estadoDestino": "", "gramatura": "", "corTrama": "", "corUrdume": "", "lyner": "" });
				}
				else if (checkBox == "Novo Produto - Copiar") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasRafia.push({ "empresa": "1", "tipoItem": "Copiar", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": prod[0].quantidade, "preco": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCoresFrente": prod[0].qtdCoresFrente, "qtdCoresVerso": prod[0].qtdCoresVerso, "gramaturaLaminado": prod[0].gramaturaLaminado, "gramaturaConvencional": prod[0].gramaturaConvencional, "sanfona": prod[0].sanfona, "medidaSanfona": prod[0].medidaSanfona, "valvula": prod[0].valvula, "medidaValvula": prod[0].medidaValvula, "estadoDestino": "", "gramatura": prod[0].gramatura, "corTrama": prod[0].corTrama, "corUrdume": prod[0].corUrdume, "lyner": prod[0].lyner, "largura": prod[0].largura, "comprimento": prod[0].comprimento });
				}
				else if (checkBox == "Produto já existente") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasRafia.push({ "empresa": "1", "tipoItem": "Existente", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": prod[0].quantidade, "preco": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCoresFrente": prod[0].qtdCoresFrente, "qtdCoresVerso": prod[0].qtdCoresVerso, "gramaturaLaminado": prod[0].gramaturaLaminado, "gramaturaConvencional": prod[0].gramaturaConvencional, "sanfona": prod[0].sanfona, "medidaSanfona": prod[0].medidaSanfona, "valvula": prod[0].valvula, "medidaValvula": prod[0].medidaValvula, "estadoDestino": "", "gramatura": prod[0].gramatura, "corTrama": prod[0].corTrama, "corUrdume": prod[0].corUrdume, "lyner": prod[0].lyner, "largura": prod[0].largura, "comprimento": prod[0].comprimento });
				}
				atualizarTabelaRafia();
			}
		});
	}
	$("#confirmModalProdutoRafia").click(function () {
		var formulario = document.getElementById("formProdutoRafia");
		if (!formulario.checkValidity()) {
		}
		else {
			formulario.addEventListener('submit', function (e) {
				e.preventDefault();
			});
			var checkbox = document.querySelector(`input[name="flexRadioRafia"]:checked`).value;
			if (checkbox == "Novo Produto - Copiar" || checkbox == "Produto já existente") {
				document.querySelector(`input[id="inputProdutoRafia"]`).required = true;
				if (!formulario.checkValidity()) {
				}
				else {
					document.getElementById("modalSelectTipoItemRafia").style.filter = "unset";
					document.getElementById("orcamentoRafia").style.filter = "unset";
					$("#modalSelectTipoItemRafia").modal('hide');
				}
			}
			else {
				document.getElementById("formProdutoRafia").style.filter = "unset";
				document.getElementById("orcamentoRafia").style.filter = "unset";
				$("#modalSelectTipoItemRafia").modal('hide');
			}
		}
	});
	function removerElemento(elementoClicado, i) {
		linhasRafia.splice(i, 1);
		atualizarTabelaRafia();
	}
	function montaJsonRafia() {
		var unidadeSel = "Rafia"
		var clienteSel = document.getElementById("filtroCliente").value;
		var orcamentoSel = document.getElementById("inputOrcamento").value;
		var vendedorSel = document.getElementById("selectVendedor").value;
		jsonFormatado = { "numOrcamentoERP": 0, "numPedidoERP": 0, "situacao": "EM EDIÇÃO", "unidade": unidadeSel, "cliente": clienteSel, "orcamento": orcamentoSel, "vendedor": vendedorSel, "itens": linhasRafia };
	}
	function salvaItensBaseClicRafia() {
		montaJsonRafia();

		var parametros = {
			"cnpj": {
				"id": parent.dadosUserLogado().cId
			},
			"jsonDocs": JSON.stringify(jsonFormatado)
		};

		$.ajax({
			url: 'https://maxiplast.clicvenda.com.br/clicVendas/rest/pedidov2/salvar',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				$("#orcamentoRafia").modal('hide');
				$('#formRafia').each(function () {
					this.reset();
				});
				linhasRafia = [];
				atualizarTabelaRafia();
				document.location.reload();
			}
		});
	}
</script>

<!--          						S C R I P T S  -  S E R A F I N A - EDICAO					-->
<script>
	function listaTipoEmbalagemFlexivelEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoEmbalagemFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoEmbalagem.map((option) => {
					let optionsTipoEmb = document.createElement('option');
					optionsTipoEmb.innerHTML = option;

					document.getElementById('tipoEmbalagemSerafinaEdicao' + idx).appendChild(optionsTipoEmb);
				});

			}
		});
	};
	function listaTipoLaminadoFlexivelEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoLaminadoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoLaminado.map((option) => {
					let optionsTipoLam = document.createElement('option');
					optionsTipoLam.innerHTML = option;

					document.getElementById('tipoLaminadoSerafinaEdicao' + idx).appendChild(optionsTipoLam);
				});
			}
		});
	};
	function listaTipoMaterialFlexivelEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoMaterialFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoMaterial.map((option) => {
					let optionstipoMat = document.createElement('option');
					optionstipoMat.innerHTML = option;

					document.getElementById('tipoMaterialSerafinaEdicao' + idx).appendChild(optionstipoMat);
				});
			}
		});
	};
	function listaPigmentosFlexivelEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaPigmentosFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.pigmentadoTransparente.map((option) => {
					let optionsPigmentoTransp = document.createElement('option');
					optionsPigmentoTransp.innerHTML = option;

					document.getElementById('pigmentadoTransparenteSerafinaEdicao' + idx).appendChild(optionsPigmentoTransp);
				});
			}
		});
	};
	function lisoImpressoFlexivelEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "lisoImpressoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.lisoImpresso.map((option) => {
					let optionsLisoImpresso = document.createElement('option');
					optionsLisoImpresso.innerHTML = option;

					document.getElementById('lisoImpressoSerafinaEdicao' + idx).appendChild(optionsLisoImpresso);
				});
			}
		});
	};
	function listaTipoSoldaFlexivelEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoSoldaFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoSolda.map((option) => {
					let optionsTipoSolda = document.createElement('option');
					optionsTipoSolda.innerHTML = option;
					document.getElementById('tipoSoldaSerafinaEdicao' + idx).appendChild(optionsTipoSolda);
				});
			}
		});
	};
	function mostraModalProdutosSerafina() {
		$("#modalSelectTipoItemSerafinaEdicao").modal('show');
	}
	function limparLinhasEdicaoSerafina() {
		linhasTableSerafinaEdicao = "";
	}
	$("#addItensSerafinaEdicao").click(function () {
		$("#modalSelectTipoItemSerafinaEdicao").modal('show');
		document.getElementById("modalSelectTipoItemSerafinaEdicao").style.filter = "drop-shadow(2px 4px 6px black)";
		document.getElementById("modalEdicaoSerafina").style.filter = "blur(2px)";
	});
	$("#cancelModalProdutoSerafinaEdicao").click(function () {
		document.getElementById("modalSelectTipoItemSerafinaEdicao").style.filter = "unset";
		document.getElementById("modalEdicaoSerafina").style.filter = "unset";
		$("#modalSelectTipoItemSerafinaEdicao").modal('hide');
	});
	function enableInputSerafinaEdicao() {
		document.querySelector(`input[id="inputProdutoSerafinaEdicao"]`).disabled = false;
	}
	function disableInputSerafinaEdicao() {
		document.querySelector(`input[id="inputProdutoSerafinaEdicao"]`).disabled = true;
	}
	function atualizarTabelaSerafinaEdicao() {

		var index;

		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				document.querySelector('#linhaTableSerafinaEdicao').innerHTML = linhasSerafinaEdicao.map(function (prod, indice) {
					index = indice;
					return `<tr id="${indice}" style="text-align: center;vertical-align: middle;">
					<th scope="row">
						<span type="button">
						<i class="bi bi-x-square-fill" style="color: red" onclick="removerElementoSerafinaEdicao(event.target, ${indice})"></i>
						</span>
					</th>
					<td><input ${prod.tipoItem != "Branco" && "disabled"} value= "${prod.item}" onkeyup="escreverValorEdicaoSerafina('item',${indice},this.value)"></input></td>
					<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.largura}" onkeyup="escreverValorEdicaoSerafina('largura',${indice},this.value)"></input></td>
					<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.altura}" onkeyup="escreverValorEdicaoSerafina('altura',${indice},this.value)"></input></td>
					<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.espessura}" onkeyup="escreverValorEdicaoSerafina('espessura',${indice},this.value)"></input></td>
					<td><input ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.unidMed}" onkeyup="escreverValorEdicaoSerafina('unidMed',${indice},this.value)"></input></td>
					<td><input type="number" value="${prod.quantidade}" onkeyup="escreverValorEdicaoSerafina('quantidade',${indice},this.value)"></input></td>
					<td>
						<select id="tipoEmbalagemSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('tipoEmbalagem',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.tipoEmbalagem}"</option>
						</select>
					</td>
					<td>
						<select id="tipoLaminadoSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('tipoLaminado',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.tipoLaminado}"</option>
						</select>
					</td>
					<td>
						<select id="tipoMaterialSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('tipoMaterial',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.tipoMaterial}"</option>
						</select>
					</td>
					<td>
						<select id="pigmentadoTransparenteSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('pigmentadoTransparente',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.pigmentadoTransparente}"</option>
						</select>
					</td>
					<td>
						<select id="lisoImpressoSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('lisoImpresso',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.lisoImpresso}"</option>
						</select>
					</td>
					<td>
						<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('qtdCores',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.qtdCores}"</option>
									<option value="1">1</option>
									<option value="2">2</option>
									<option value="3">3</option>
									<option value="4">4</option>
									<option value="5">5</option>
									<option value="6">6</option>
									<option value="7">7</option>
									<option value="8">8</option>
						</select>
					</td>
					<td>
						<select id="tipoSoldaSerafinaEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoSerafina('tipoSolda',${indice},this.options[this.selectedIndex].text)">
									<option selected disabled>"${prod.tipoSolda}"</option>
						</select>
					</td>
					<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.prazoEntrega}" onkeyup="escreverValorEdicaoSerafina('prazoEntrega',${indice},this.value)"></td>
					<td><input value="${prod.obs}" onkeyup="escreverValorEdicaoSerafina('obs',${indice},this.value)"></td>
					<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorEdicaoSerafina('preco',${indice},this.value)"></td>
					<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorEdicaoSerafina('total',${indice},this.value)"></td>
				</tr>`;
				}).join("");
			},
			complete: function () {
				listaTipoEmbalagemFlexivelEdicao(index);
				listaTipoLaminadoFlexivelEdicao(index);
				listaTipoMaterialFlexivelEdicao(index);
				listaPigmentosFlexivelEdicao(index);
				lisoImpressoFlexivelEdicao(index);
				listaTipoSoldaFlexivelEdicao(index);
			}
		});
	}
	function addLinhasSerafinaEdicao() {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				var produtoSel = document.getElementById("inputProdutoSerafinaEdicao").value;
				var checkBox = document.querySelector(`input[name="flexRadioSerafinaEdicao"]:checked`).value;
				if (checkBox == "Novo Produto - Branco") {
					linhasSerafinaEdicao.push({ "empresa": "2", "tipoItem": "Branco", "id": "", "item": "", "unidMed": "", "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": "", "tipoLaminado": "", "tipoMaterial": "", "pigmentadoTransparente": "", "lisoImpresso": "", "qtdCores": "", "tipoSolda": "", "largura": "", "altura": "", "espessura": "", "prazoEntrega": "", "obs": "" });
				}
				else if (checkBox == "Novo Produto - Copiar") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasSerafinaEdicao.push({ "empresa": "2", "tipoItem": "Copiar", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "tipoMaterial": prod[0].tipoMaterial, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCores": prod[0].qtdCoresFrente, "tipoSolda": prod[0].tipoSolda, "largura": prod[0].largura, "altura": prod[0].altura, "espessura": prod[0].espessura, "prazoEntrega": "", "obs": "" });
				}
				else if (checkBox == "Produto já existente") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasSerafinaEdicao.push({ "empresa": "2", "tipoItem": "Existente", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "tipoMaterial": prod[0].tipoMaterial, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCores": prod[0].qtdCoresFrente, "tipoSolda": prod[0].tipoSolda, "largura": prod[0].largura, "altura": prod[0].altura, "espessura": prod[0].espessura, "prazoEntrega": "", "obs": "" });
				}
				atualizarTabelaSerafinaEdicao();
			}
		});
	}
	$("#confirmModalProdutoSerafinaEdicao").click(function () {
		var formulario = document.getElementById("formProdutoSerafinaEdicao");
		if (!formulario.checkValidity()) {
		}
		else {
			formulario.addEventListener('submit', function (e) {
				e.preventDefault();
			});
			var checkbox = document.querySelector(`input[name="flexRadioSerafinaEdicao"]:checked`).value;
			if (checkbox == "Novo Produto - Copiar" || checkbox == "Produto já existente") {
				document.querySelector(`input[id="inputProdutoSerafinaEdicao"]`).required = true;
				if (!formulario.checkValidity()) {
				}
				else {
					document.getElementById("modalSelectTipoItemSerafinaEdicao").style.filter = "unset";
					document.getElementById("modalEdicaoSerafina").style.filter = "unset";
					$("#modalSelectTipoItemSerafinaEdicao").modal('hide');
				}
			}
			else {
				document.getElementById("formProdutoSerafinaEdicao").style.filter = "unset";
				document.getElementById("modalEdicaoSerafina").style.filter = "unset";
				$("#modalSelectTipoItemSerafinaEdicao").modal('hide');
			}
		}
	});
	function escreverValorEdicaoSerafina(prop, i, value) {
		var item = linhasSerafinaEdicao[i];
		item[prop] = value;
	}
	function montaJsonSerafinaEdicao() {
		jsonFormatado = { "numOrcamentoERP": 0, "numPedidoERP": 0, "situacao": "EM EDIÇÃO", "unidade": "Serafina", "cliente": clienteSel, "orcamento": orcamentoSel, "vendedor": vendedorSel, "itens": linhasSerafinaEdicao };
	}
	function removerElementoSerafinaEdicao(elementoClicado, i) {
		linhasSerafinaEdicao.splice(i, 1);
		atualizarTabelaSerafinaEdicao();
	}
	function atualizarItensBaseClicSerafina() {
		montaJsonSerafinaEdicao();
		var parametros = {
			"cnpj": {
				"id": parent.dadosUserLogado().cId
			},
			"jsonDocs": JSON.stringify(jsonFormatado)
		};
		$.ajax({
			url: 'https://maxiplast.clicvenda.com.br/clicVendas/rest/pedidov2/salvar/' + idSel,
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				$("#modalEdicaoSerafina").modal('hide');
				$('#formEdicaoSerafina').each(function () {
					this.reset();
				});
				linhasSerafinaEdicao = [];
				atualizarTabelaSerafinaEdicao();
				document.location.reload();
			}
		});
	}
	
	function enviarWebServiceMaxiplastSerafina() {

		montaJsonMatrizEdicao();

		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 996,
			pRotina: "enviarOrcRafia",
			pItem: jsonFormatado
		};


		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				enviarOrcSucesso(jsonFormatado.numOrcamentoERP, jsonFormatado.unidade);
			},
			beforeSend: function () {

			},
			complete: function () {

			},
			error: function () {

			}
		});
	}
</script>

</script>

<!--          						S C R I P T S  -  S E R A F I N A          					-->
<script>
	function listaTipoEmbalagemFlexivel(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoEmbalagemFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoEmbalagem.map((option) => {
					let optionsTipoEmb = document.createElement('option');
					optionsTipoEmb.innerHTML = option;

					document.getElementById('tipoEmbalagemSerafina' + idx).appendChild(optionsTipoEmb);
				});

			}
		});
	};
	function listaTipoLaminadoFlexivel(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoLaminadoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				objRetorno.tipoLaminado.map((option) => {
					let optionsTipoLam = document.createElement('option');
					optionsTipoLam.innerHTML = option;
					document.getElementById('tipoLaminadoSerafina' + idx).appendChild(optionsTipoLam);
				});
			}
		});
	};
	function listaTipoMaterialFlexivel(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoMaterialFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoMaterial.map((option) => {
					let optionstipoMat = document.createElement('option');
					optionstipoMat.innerHTML = option;

					document.getElementById('tipoMaterialSerafina' + idx).appendChild(optionstipoMat);
				});
			}
		});
	};
	function listaPigmentosFlexivel(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaPigmentosFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.pigmentadoTransparente.map((option) => {
					let optionsPigmentoTransp = document.createElement('option');
					optionsPigmentoTransp.innerHTML = option;

					document.getElementById('pigmentadoTransparenteSerafina' + idx).appendChild(optionsPigmentoTransp);
				});
			}
		});
	};
	function lisoImpressoFlexivel(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "lisoImpressoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.lisoImpresso.map((option) => {
					let optionsLisoImpresso = document.createElement('option');
					optionsLisoImpresso.innerHTML = option;

					document.getElementById('lisoImpressoSerafina' + idx).appendChild(optionsLisoImpresso);
				});
			}
		});
	};
	function listaTipoSoldaFlexivel(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoSoldaFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				objRetorno.tipoSolda.map((option) => {
					let optionsTipoSolda = document.createElement('option');
					optionsTipoSolda.innerHTML = option;
					document.getElementById('tipoSoldaSerafina' + idx).appendChild(optionsTipoSolda);
				});
			}
		});
	};
	$("#addItensSerafina").click(function () {
		var formulario = document.getElementById("formSerafina");
		if (!formulario.checkValidity()) {
		}
		else {
			formulario.addEventListener('submit', function (e) {
				e.preventDefault();
			});
			$("#modalSelectTipoItemSerafina").modal('show');
			document.getElementById("modalSelectTipoItemSerafina").style.filter = "drop-shadow(2px 4px 6px black)";
			document.getElementById("orcamentoSerafina").style.filter = "blur(2px)";
		}
	});
	$("#confirmModalProdutoSerafina").click(function () {
		var formulario = document.getElementById("formProdutoSerafina");
		if (!formulario.checkValidity()) {
		}
		else {
			formulario.addEventListener('submit', function (e) {
				e.preventDefault();
			});
			var checkbox = document.querySelector(`input[name="flexRadioSerafina"]:checked`).value;
			if (checkbox == "Novo Produto - Copiar" || checkbox == "Produto já existente") {
				document.querySelector(`input[id="inputProdutoSerafina"]`).required = true;
				if (!formulario.checkValidity()) {
				}
				else {
					document.getElementById("modalSelectTipoItemSerafina").style.filter = "unset";
					document.getElementById("orcamentoSerafina").style.filter = "unset";
					$("#modalSelectTipoItemSerafina").modal('hide');
				}
			}
			else {
				document.getElementById("formProdutoSerafina").style.filter = "unset";
				document.getElementById("orcamentoSerafina").style.filter = "unset";
				$("#modalSelectTipoItemSerafina").modal('hide');
			}
		}
	});
	$("#cancelModalProdutoSerafina").click(function () {
		document.getElementById("modalSelectTipoItemSerafina").style.filter = "unset";
		document.getElementById("orcamentoSerafina").style.filter = "unset";
		$("#modalSelectTipoItemSerafina").modal('hide');
	});
	function enableInputSerafina() {
		document.querySelector(`input[id="inputProdutoSerafina"]`).disabled = false;
	}
	function disableInputSerafina() {
		document.querySelector(`input[id="inputProdutoSerafina"]`).disabled = true;
	}
	function addLinhasSerafina() {

		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				var produtoSel = document.getElementById("inputProdutoSerafina").value;
				var checkBox = document.querySelector(`input[name="flexRadioSerafina"]:checked`).value;
				if (checkBox == "Novo Produto - Branco") {
					linhasSerafina.push({ "empresa": "2", "tipoItem": "Branco", "id": "", "item": "", "unidMed": "", "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": "", "tipoLaminado": "", "tipoMaterial": "", "pigmentadoTransparente": "", "lisoImpresso": "", "qtdCores": "", "tipoSolda": "", "largura": "", "altura": "", "espessura": "", "prazoEntrega": "", "obs": "" });
				}
				else if (checkBox == "Novo Produto - Copiar") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasSerafina.push({ "empresa": "2", "tipoItem": "Copiar", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "tipoMaterial": prod[0].tipoMaterial, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCores": prod[0].qtdCoresFrente, "tipoSolda": prod[0].tipoSolda, "largura": prod[0].largura, "altura": prod[0].altura, "espessura": prod[0].espessura, "prazoEntrega": "", "obs": "" });
				}
				else if (checkBox == "Produto já existente") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasSerafina.push({ "empresa": "2", "tipoItem": "Existente", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "tipoMaterial": prod[0].tipoMaterial, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCores": prod[0].qtdCoresFrente, "tipoSolda": prod[0].tipoSolda, "largura": prod[0].largura, "altura": prod[0].altura, "espessura": prod[0].espessura, "prazoEntrega": "", "obs": "" });
				}

				atualizarTabelaSerafina();
			}
		});
	}
	function escreverValorSerafina(prop, i, value) {
		var item = linhasSerafina[i];
		item[prop] = value;
	}
	function atualizarTabelaSerafina() {

		var index;

		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				document.querySelector('#linhaTableSerafina').innerHTML = linhasSerafina.map(function (prod, indice) {
					index = indice;
					return `<tr id="${indice}" style="text-align: center;vertical-align: middle;">
						<th scope="row">
							<span type="button">
							<i class="bi bi-x-square-fill" style="color: red" onclick="removerElementoSerafina(event.target, ${indice})"></i>
							</span>
						</th>
						<td><input ${prod.tipoItem != "Branco" && "disabled"} value= "${prod.item}" onkeyup="escreverValorSerafina('item',${indice},this.value)"></input></td>
						<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.largura}" onkeyup="escreverValorSerafina('largura',${indice},this.value)"></input></td>
						<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.altura}" onkeyup="escreverValorSerafina('altura',${indice},this.value)"></input></td>
						<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.espessura}" onkeyup="escreverValorSerafina('espessura',${indice},this.value)"></input></td>
						<td><input ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.unidMed}" onkeyup="escreverValorSerafina('unidMed',${indice},this.value)"></input></td>
						<td><input type="number" value="${prod.quantidade}" onkeyup="escreverValorSerafina('quantidade',${indice},this.value)"></input></td>
						<td>
							<select id="tipoEmbalagemSerafina${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorSerafina('tipoEmbalagem',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.tipoEmbalagem}"</option>
							</select>
						</td>
						<td>
							<select  id="tipoLaminadoSerafina${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorSerafina('tipoLaminado',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.tipoLaminado}"</option>
							</select>
						</td>
						<td>
							<select id="tipoMaterialSerafina${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorSerafina('tipoMaterial',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.tipoMaterial}"</option>
						</td>
						<td>
							<select id="pigmentadoTransparenteSerafina${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorSerafina('pigmentadoTransparente',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.pigmentadoTransparente}"</option>
							</select>
						</td>
						<td>
							<select  id="lisoImpressoSerafina${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorSerafina('lisoImpresso',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.lisoImpresso}"</option>
							</select>
						</td>
						<td>
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorSerafina('qtdCores',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.qtdCores}"</option>
										<option value="1">1</option>
										<option value="2">2</option>
										<option value="3">3</option>
										<option value="4">4</option>
										<option value="5">5</option>
										<option value="6">6</option>
										<option value="7">7</option>
										<option value="8">8</option>
							</select>
						</td>
						<td>
							<select id="tipoSoldaSerafina${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorSerafina('tipoSolda',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.tipoSolda}"</option>
							</select>
						</td>
						<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.prazoEntrega}" onkeyup="escreverValorSerafina('prazoEntrega',${indice},this.value)"></td>
						<td><input value= "${prod.obs}" onkeyup="escreverValorSerafina('obs',${indice},this.value)"></td>
						<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorSerafina('preco',${indice},this.value)"></td>
						<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorSerafina('total',${indice},this.value)"></td>
					</tr>`;

				}).join("");
			},
			complete: function () {
				listaTipoEmbalagemFlexivel(index);
				listaTipoLaminadoFlexivel(index);
				listaTipoMaterialFlexivel(index);
				listaPigmentosFlexivel(index);
				lisoImpressoFlexivel(index);
				listaTipoSoldaFlexivel(index);
			}
		});
	}
	function montaJsonSerafina() {

		var unidadeSel = "Serafina";
		var clienteSel = document.getElementById("filtroClienteSerafina").value;
		var orcamentoSel = document.getElementById("inputOrcamentoSerafina").value;
		var vendedorSel = document.getElementById("selectVendedorSerafina").value;
		jsonFormatado = { "numOrcamentoERP": 0, "numPedidoERP": 0, "situacao": "EM EDIÇÃO", "unidade": unidadeSel, "cliente": clienteSel, "orcamento": orcamentoSel, "vendedor": vendedorSel, "itens": linhasSerafina };

	}
	function removerElementoSerafina(elementoClicado, i) {
		linhasSerafina.splice(i, 1);
		atualizarTabelaSerafina();
	}
	function salvaItensBaseClicSerafina() {

		montaJsonSerafina();

		var parametros = {
			"cnpj": {
				"id": parent.dadosUserLogado().cId
			},
			"jsonDocs": JSON.stringify(jsonFormatado)
		};
		$.ajax({
			url: 'https://maxiplast.clicvenda.com.br/clicVendas/rest/pedidov2/salvar',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				$("#orcamentoSerafina").modal('hide');
				$('#formSerafina').each(function () {
					this.reset();
				});
				linhasSerafina = [];
				atualizarTabelaSerafina();
				document.location.reload();
			}
		});
	}
</script>

<!--          						S C R I P T S  -  M A T R I Z - EDICAO					-->
<script>
	function listaTipoEmbalagemMatrizEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoEmbalagemFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoEmbalagem.map((option) => {
					let optionsTipoEmb = document.createElement('option');
					optionsTipoEmb.innerHTML = option;
					document.getElementById('tipoEmbalagemMatrizEdicao' + idx).appendChild(optionsTipoEmb);
				});

			}
		});
	};
	function listaTipoLaminadoMatrizEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoLaminadoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoLaminado.map((option) => {
					let optionsTipoLam = document.createElement('option');
					optionsTipoLam.innerHTML = option;
					document.getElementById('tipoLaminadoMatrizEdicao' + idx).appendChild(optionsTipoLam);
				});
			}
		});
	};
	function listaTipoMaterialMatrizEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoMaterialFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoMaterial.map((option) => {
					let optionstipoMat = document.createElement('option');
					optionstipoMat.innerHTML = option;

					document.getElementById('tipoMaterialMatrizEdicao' + idx).appendChild(optionstipoMat);
				});
			}
		});
	};
	function listaPigmentosMatrizEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaPigmentosFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.pigmentadoTransparente.map((option) => {
					let optionsPigmentoTransp = document.createElement('option');
					optionsPigmentoTransp.innerHTML = option;

					document.getElementById('pigmentadoTransparenteMatrizEdicao' + idx).appendChild(optionsPigmentoTransp);
				});
			}
		});
	};
	function lisoImpressoMatrizEdicao(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "lisoImpressoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.lisoImpresso.map((option) => {
					let optionsLisoImpresso = document.createElement('option');
					optionsLisoImpresso.innerHTML = option;

					document.getElementById('lisoImpressoMatrizEdicao' + idx).appendChild(optionsLisoImpresso);
				});
			}
		});
	};
	function listaTipoSoldaMatrizEdicao(idx) {

		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoSoldaFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoSolda.map((option) => {
					let optionsTipoSolda = document.createElement('option');
					optionsTipoSolda.innerHTML = option;

					document.getElementById('tipoSoldaMatrizEdicao' + idx).appendChild(optionsTipoSolda);
				});
			}
		});
	}
	function mostraModalProdutosMatriz() {
		$("#modalSelectTipoItemMatrizEdicao").modal('show');
	}
	function limparLinhasEdicaoMatriz() {
		linhasTableMatrizEdicao = "";
	}
	$("#addItensMatrizEdicao").click(function () {
		$("#modalSelectTipoItemMatrizEdicao").modal('show');
		document.getElementById("modalSelectTipoItemMatrizEdicao").style.filter = "drop-shadow(2px 4px 6px black)";
		document.getElementById("modalEdicaoMatriz").style.filter = "blur(2px)";
	});
	$("#cancelModalProdutoMatrizEdicao").click(function () {
		document.getElementById("modalSelectTipoItemMatrizEdicao").style.filter = "unset";
		document.getElementById("modalEdicaoMatriz").style.filter = "unset";
		$("#modalSelectTipoItemMatrizEdicao").modal('hide');
	});
	function enableInputMatrizEdicao() {
		document.querySelector(`input[id="inputProdutoMatrizEdicao"]`).disabled = false;
	}
	function disableInputMatrizEdicao() {
		document.querySelector(`input[id="inputProdutoMatrizEdicao"]`).disabled = true;
	}
	function atualizarTabelaMatrizEdicao() {
		var index;

		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				document.querySelector('#linhaTableMatrizEdicao').innerHTML = linhasMatrizEdicao.map(function (prod, indice) {
					index = indice;
					return `<tr id="${indice}" style="text-align: center;vertical-align: middle;">
							<th scope="row">
								<span type="button">
								<i class="bi bi-x-square-fill" style="color: red" onclick="removerElementoMatrizEdicao(event.target, ${indice})"></i>
								</span>
							</th>
							<td><input ${prod.tipoItem != "Branco" && "disabled"} value= "${prod.item}" onkeyup="escreverValorEdicaoMatriz('item',${indice},this.value)"></input></td>
							<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.largura}" onkeyup="escreverValorEdicaoMatriz('largura',${indice},this.value)"></input></td>
							<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.altura}" onkeyup="escreverValorEdicaoMatriz('altura',${indice},this.value)"></input></td>
							<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.espessura}" onkeyup="escreverValorEdicaoMatriz('espessura',${indice},this.value)"></input></td>
							<td><input ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.unidMed}" onkeyup="escreverValorEdicaoMatriz('unidMed',${indice},this.value)"></input></td>
							<td><input type="number" value= "${prod.quantidade}" onkeyup="escreverValorEdicaoMatriz('quantidade',${indice},this.value)"></input></td>
							<td>
								<select id="tipoEmbalagemMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('tipoEmbalagem',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.tipoEmbalagem}"</option>
								</select>
							</td>
							<td>
								<select id="tipoLaminadoMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('tipoLaminado',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.tipoLaminado}"</option>
								</select>
							</td>
							<td>
								<select id="tipoMaterialMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('tipoMaterial',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.tipoMaterial}"</option>
								</select>
							</td>
							<td>
								<select id="pigmentadoTransparenteMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('pigmentadoTransparente',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.pigmentadoTransparente}"</option>
								</select>
							</td>
							<td>
								<select id="lisoImpressoMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('lisoImpresso',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.lisoImpresso}"</option>
								</select>
							</td>
							<td>
								<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('qtdCores',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.qtdCores}"</option>
											<option value="1">1</option>
											<option value="2">2</option>
											<option value="3">3</option>
											<option value="4">4</option>
											<option value="5">5</option>
											<option value="6">6</option>
											<option value="7">7</option>
											<option value="8">8</option>
								</select>
							</td>
							<td>
								<select id="tipoSoldaMatrizEdicao${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorEdicaoMatriz('tipoSolda',${indice},this.options[this.selectedIndex].text)">
											<option selected disabled>"${prod.tipoSolda}"</option>
								</select>
							</td>
							<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.prazoEntrega}" onkeyup="escreverValorEdicaoMatriz('prazoEntrega',${indice},this.value)"></td>
							<td><input value="${prod.obs}" onkeyup="escreverValorEdicaoMatriz('obs',${indice},this.value)"></td>
							<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorEdicaoMatriz('preco',${indice},this.value)"></td>
							<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorEdicaoMatriz('total',${indice},this.value)"></td>
						</tr>`;
				}).join("");
			},
			complete: function () {
				listaTipoEmbalagemMatrizEdicao(index);
				listaTipoLaminadoMatrizEdicao(index);
				listaTipoMaterialMatrizEdicao(index);
				listaPigmentosMatrizEdicao(index);
				lisoImpressoMatrizEdicao(index);
				listaTipoSoldaMatrizEdicao(index);
			}
		});
	}
	function addLinhasMatrizEdicao() {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				var produtoSel = document.getElementById("inputProdutoMatrizEdicao").value;
				var checkBox = document.querySelector(`input[name="flexRadioMatrizEdicao"]:checked`).value;
				if (checkBox == "Novo Produto - Branco") {
					linhasMatrizEdicao.push({ "empresa": "3", "tipoItem": "Branco", "id": "", "item": "", "unidMed": "", "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": "", "tipoLaminado": "", "tipoMaterial": "", "pigmentadoTransparente": "", "lisoImpresso": "", "qtdCores": "", "tipoSolda": "", "largura": "", "altura": "", "espessura": "", "prazoEntrega": "", "obs": "" });
				}
				else if (checkBox == "Novo Produto - Copiar") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasMatrizEdicao.push({ "empresa": "3", "tipoItem": "Copiar", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "tipoMaterial": prod[0].tipoMaterial, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCores": prod[0].qtdCoresFrente, "tipoSolda": prod[0].tipoSolda, "largura": prod[0].largura, "altura": prod[0].altura, "espessura": prod[0].espessura, "prazoEntrega": "", "obs": "" });
				}
				else if (checkBox == "Produto já existente") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasMatrizEdicao.push({ "empresa": "3", "tipoItem": "Existente", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "tipoMaterial": prod[0].tipoMaterial, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCores": prod[0].qtdCoresFrente, "tipoSolda": prod[0].tipoSolda, "largura": prod[0].largura, "altura": prod[0].altura, "espessura": prod[0].espessura, "prazoEntrega": "", "obs": "" });
				}
				atualizarTabelaMatrizEdicao();
			}
		});
	}
	$("#confirmModalProdutoMatrizEdicao").click(function () {
		var formulario = document.getElementById("formProdutoMatrizEdicao");
		if (!formulario.checkValidity()) {
		}
		else {
			formulario.addEventListener('submit', function (e) {
				e.preventDefault();
			});
			var checkbox = document.querySelector(`input[name="flexRadioMatrizEdicao"]:checked`).value;
			if (checkbox == "Novo Produto - Copiar" || checkbox == "Produto já existente") {
				document.querySelector(`input[id="inputProdutoMatrizEdicao"]`).required = true;
				if (!formulario.checkValidity()) {
				}
				else {
					document.getElementById("modalSelectTipoItemMatrizEdicao").style.filter = "unset";
					document.getElementById("modalEdicaoMatriz").style.filter = "unset";
					$("#modalSelectTipoItemMatrizEdicao").modal('hide');
				}
			}
			else {
				document.getElementById("formProdutoMatrizEdicao").style.filter = "unset";
				document.getElementById("modalEdicaoMatriz").style.filter = "unset";
				$("#modalSelectTipoItemMatrizEdicao").modal('hide');
			}
		}
	});
	function escreverValorEdicaoMatriz(prop, i, value) {
		var item = linhasMatrizEdicao[i];
		item[prop] = value;
	}
	function montaJsonMatrizEdicao() {
		jsonFormatado = { "numOrcamentoERP": idSel.toString(), "numPedidoERP": 0, "situacao": "EM EDIÇÃO", "unidade": "Matriz", "cliente": clienteSel, "orcamento": orcamentoSel, "vendedor": vendedorSel, "itens": linhasMatrizEdicao };
	}
	function removerElementoMatrizEdicao(elementoClicado, i) {
		linhasMatrizEdicao.splice(i, 1);
		atualizarTabelaMatrizEdicao();
	}
	function atualizarItensBaseClicMatriz() {

		montaJsonMatrizEdicao();

		var parametros = {
			"cnpj": {
				"id": parent.dadosUserLogado().cId
			},
			"jsonDocs": JSON.stringify(jsonFormatado)
		};
		$.ajax({
			url: 'https://maxiplast.clicvenda.com.br/clicVendas/rest/pedidov2/salvar/' + idSel,
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				$("#modalEdicaoMatriz").modal('hide');
				$('#formEdicaoMatriz').each(function () {
					this.reset();
				});
				linhasMatrizEdicao = [];
				atualizarTabelaMatrizEdicao();
				document.location.reload();
			}
		});
	}

	function enviarWebServiceMaxiplastMatriz() {

		montaJsonMatrizEdicao();

		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 996,
			pRotina: "enviarOrcRafia",
			pItem: jsonFormatado
		};


		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				enviarOrcSucesso(jsonFormatado.numOrcamentoERP, jsonFormatado.unidade);
			},
			beforeSend: function () {

			},
			complete: function () {

			},
			error: function () {

			}
		});


	}
</script>

<!--          						S C R I P T S  -	M A T R I Z         					-->
<script>
	function listaTipoEmbalagemMatriz(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoEmbalagemFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoEmbalagem.map((option) => {
					let optionsTipoEmb = document.createElement('option');
					optionsTipoEmb.innerHTML = option;
					document.getElementById('tipoEmbalagemMatriz' + idx).appendChild(optionsTipoEmb);
				});

			}
		});
	};
	function listaTipoLaminadoMatriz(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoLaminadoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoLaminado.map((option) => {
					let optionsTipoLam = document.createElement('option');
					optionsTipoLam.innerHTML = option;
					document.getElementById('tipoLaminadoMatriz' + idx).appendChild(optionsTipoLam);
				});
			}
		});
	};
	function listaTipoMaterialMatriz(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoMaterialFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoMaterial.map((option) => {
					let optionstipoMat = document.createElement('option');
					optionstipoMat.innerHTML = option;

					document.getElementById('tipoMaterialMatriz' + idx).appendChild(optionstipoMat);
				});
			}
		});
	};
	function listaPigmentosMatriz(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaPigmentosFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.pigmentadoTransparente.map((option) => {
					let optionsPigmentoTransp = document.createElement('option');
					optionsPigmentoTransp.innerHTML = option;

					document.getElementById('pigmentadoTransparenteMatriz' + idx).appendChild(optionsPigmentoTransp);
				});
			}
		});
	};
	function lisoImpressoMatriz(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "lisoImpressoFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.lisoImpresso.map((option) => {
					let optionsLisoImpresso = document.createElement('option');
					optionsLisoImpresso.innerHTML = option;

					document.getElementById('lisoImpressoMatriz' + idx).appendChild(optionsLisoImpresso);
				});
			}
		});
	};
	function listaTipoSoldaMatriz(idx) {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaTipoSoldaFlexivel"
		};

		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);

				objRetorno.tipoSolda.map((option) => {
					let optionsTipoSolda = document.createElement('option');
					optionsTipoSolda.innerHTML = option;

					document.getElementById('tipoSoldaMatriz' + idx).appendChild(optionsTipoSolda);
				});
			}
		});
	};
	$("#addItensMatriz").click(function () {
		var formulario = document.getElementById("formMatriz");
		if (!formulario.checkValidity()) {
		}
		else {
			formulario.addEventListener('submit', function (e) {
				e.preventDefault();
			});
			$("#modalSelectTipoItemMatriz").modal('show');
			document.getElementById("modalSelectTipoItemMatriz").style.filter = "drop-shadow(2px 4px 6px black)";
			document.getElementById("orcamentoMatriz").style.filter = "blur(2px)";
		}
	});
	$("#confirmModalProdutoMatriz").click(function () {
		var formulario = document.getElementById("formProdutoMatriz");
		if (!formulario.checkValidity()) {
		}
		else {
			formulario.addEventListener('submit', function (e) {
				e.preventDefault();
			});
			var checkbox = document.querySelector(`input[name="flexRadioMatriz"]:checked`).value;
			if (checkbox == "Novo Produto - Copiar" || checkbox == "Produto já existente") {
				document.querySelector(`input[id="inputProdutoMatriz"]`).required = true;
				if (!formulario.checkValidity()) {
				}
				else {
					document.getElementById("modalSelectTipoItemMatriz").style.filter = "unset";
					document.getElementById("orcamentoMatriz").style.filter = "unset";
					$("#modalSelectTipoItemMatriz").modal('hide');
				}
			}
			else {
				document.getElementById("formProdutoMatriz").style.filter = "unset";
				document.getElementById("orcamentoMatriz").style.filter = "unset";
				$("#modalSelectTipoItemMatriz").modal('hide');
			}
		}
	});
	$("#cancelModalProdutoMatriz").click(function () {
		document.getElementById("modalSelectTipoItemMatriz").style.filter = "unset";
		document.getElementById("orcamentoMatriz").style.filter = "unset";
		$("#modalSelectTipoItemMatriz").modal('hide');
	});
	function enableInputMatriz() {
		document.querySelector(`input[id="inputProdutoMatriz"]`).disabled = false;
	}
	function disableInputMatriz() {
		document.querySelector(`input[id="inputProdutoMatriz"]`).disabled = true;
	}
	function addLinhasMatriz() {
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				var objRetorno = JSON.parse(response);
				var produtoSel = document.getElementById("inputProdutoMatriz").value;
				var checkBox = document.querySelector(`input[name="flexRadioMatriz"]:checked`).value;
				if (checkBox == "Novo Produto - Branco") {
					linhasMatriz.push({ "empresa": "3", "tipoItem": "Branco", "id": "", "item": "", "unidMed": "", "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": "", "tipoLaminado": "", "tipoMaterial": "", "pigmentadoTransparente": "", "lisoImpresso": "", "qtdCores": "", "tipoSolda": "", "largura": "", "altura": "", "espessura": "", "prazoEntrega": "", "obs": "" });
				}
				else if (checkBox == "Novo Produto - Copiar") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasMatriz.push({ "empresa": "3", "tipoItem": "Copiar", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "tipoMaterial": prod[0].tipoMaterial, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCores": prod[0].qtdCoresFrente, "tipoSolda": prod[0].tipoSolda, "largura": prod[0].largura, "altura": prod[0].altura, "espessura": prod[0].espessura, "prazoEntrega": "", "obs": "" });
				}
				else if (checkBox == "Produto já existente") {
					var prod = objRetorno.filter(({ item }) => item == produtoSel);
					linhasMatriz.push({ "empresa": "3", "tipoItem": "Existente", "id": prod[0].codPro, "item": prod[0].item, "unidMed": prod[0].unidMed, "quantidade": "", "preco": "", "total": "", "tipoEmbalagem": prod[0].tipoEmbalagem, "tipoLaminado": prod[0].tipoLaminado, "tipoMaterial": prod[0].tipoMaterial, "pigmentadoTransparente": prod[0].pigmentadoTransparente, "lisoImpresso": prod[0].lisoImpresso, "qtdCores": prod[0].qtdCoresFrente, "tipoSolda": prod[0].tipoSolda, "largura": prod[0].largura, "altura": prod[0].altura, "espessura": prod[0].espessura, "prazoEntrega": "", "obs": "" });
				}
				atualizarTabelaMatriz();
			}
		});
	}
	function escreverValorMatriz(prop, i, value) {
		var item = linhasMatriz[i];
		item[prop] = value;
	}
	function atualizarTabelaMatriz() {

		var index;
		var parametros = {
			idCvtccnpj: parent.dadosUserLogadoPersonalizado().cId,
			numreg: 750,
			pRotina: "listaProdutosMatrizMock"
		};
		$.ajax({
			url: parent.dadosUserLogadoPersonalizado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				document.querySelector('#linhaTableMatriz').innerHTML = linhasMatriz.map(function (prod, indice) {
					index = indice;
					return `<tr id="${indice}" style="text-align: center;vertical-align: middle;">
						<th scope="row">
							<span type="button">
							<i class="bi bi-x-square-fill" style="color: red" onclick="removerElementoMatriz(event.target, ${indice})"></i>
							</span>
						</th>
						<td><input ${prod.tipoItem != "Branco" && "disabled"} value= "${prod.item}" onkeyup="escreverValorMatriz('item',${indice},this.value)"></input></td>
						<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.largura}" onkeyup="escreverValorMatriz('largura',${indice},this.value)"></input></td>
						<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.altura}" onkeyup="escreverValorMatriz('altura',${indice},this.value)"></input></td>
						<td><input type="number" ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.espessura}" onkeyup="escreverValorMatriz('espessura',${indice},this.value)"></input></td>
						<td><input ${prod.tipoItem === "Existente" && "disabled"} value= "${prod.unidMed}" onkeyup="escreverValorMatriz('unidMed',${indice},this.value)"></input></td>
						<td><input type="number" value="${prod.quantidade}" onkeyup="escreverValorMatriz('quantidade',${indice},this.value)"></input></td>
						<td>
							<select id="tipoEmbalagemMatriz${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorMatriz('tipoEmbalagem',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.tipoEmbalagem}"</option>
							</select>
						</td>
						<td>
							<select id="tipoLaminadoMatriz${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorMatriz('tipoLaminado',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.tipoLaminado}"</option>
							</select>
						</td>
						<td>
							<select id="tipoMaterialMatriz${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorMatriz('tipoMaterial',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.tipoMaterial}"</option>
							</select>
						</td>
						<td>
							<select  id="pigmentadoTransparenteMatriz${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorMatriz('pigmentadoTransparente',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.pigmentadoTransparente}"</option>
							</select>
						</td>
						<td>
							<select id="lisoImpressoMatriz${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorMatriz('lisoImpresso',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.lisoImpresso}"</option>
							</select>
						</td>
						<td>
							<select ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorMatriz('qtdCores',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.qtdCores}"</option>
										<option value="1">1</option>
										<option value="2">2</option>
										<option value="3">3</option>
										<option value="4">4</option>
										<option value="5">5</option>
										<option value="6">6</option>
										<option value="7">7</option>
										<option value="8">8</option>
							</select>
						</td>
						<td>
							<select id="tipoSoldaMatriz${indice}" ${prod.tipoItem === "Existente" && "disabled"} onchange="escreverValorMatriz('tipoSolda',${indice},this.options[this.selectedIndex].text)">
										<option selected disabled>"${prod.tipoSolda}"</option>
							</select>
						</td>
						<td><input ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} value="${prod.prazoEntrega}" onkeyup="escreverValorMatriz('prazoEntrega',${indice},this.value)"></td>
						<td><input value="${prod.obs}" onkeyup="escreverValorMatriz('obs',${indice},this.value)"></td>
						<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorMatriz('preco',${indice},this.value)"></td>
						<td><input type="number" ${(prod.tipoItem === "Existente" || prod.tipoItem === "Branco" || prod.tipoItem === "Copiar") && "disabled"} onkeyup="escreverValorMatriz('total',${indice},this.value)"></td>
					</tr>`;
				}).join("");
			},
			complete: function () {
				listaTipoEmbalagemMatriz(index);
				listaTipoLaminadoMatriz(index);
				listaTipoMaterialMatriz(index);
				listaPigmentosMatriz(index);
				lisoImpressoMatriz(index);
				listaTipoSoldaMatriz(index);
			}
		});
	}
	function removerElementoMatriz(elementoClicado, i) {
		linhasMatriz.splice(i, 1);
		atualizarTabelaMatriz();
	}
	function montaJsonMatriz() {
		var unidadeSel = "Matriz";
		var clienteSel = document.getElementById("filtroClienteMatriz").value;
		var orcamentoSel = document.getElementById("inputOrcamentoMatriz").value;
		var vendedorSel = document.getElementById("selectVendedorMatriz").value;
		jsonFormatado = { "numOrcamentoERP": 0, "numPedidoERP": 0, "situacao": "EM EDIÇÃO", "unidade": unidadeSel, "cliente": clienteSel, "orcamento": orcamentoSel, "vendedor": vendedorSel, "itens": linhasMatriz };
	}
	function salvaItensBaseClicMatriz() {
		montaJsonMatriz();

		var parametros = {
			"cnpj": {
				"id": parent.dadosUserLogado().cId
			},
			"jsonDocs": JSON.stringify(jsonFormatado)
		};
		$.ajax({
			url: 'https://maxiplast.clicvenda.com.br/clicVendas/rest/pedidov2/salvar',
			type: "POST",
			data: JSON.stringify(parametros),
			success: function (response) {
				$("#orcamentoMatriz").modal('hide');
				$('#formMatriz').each(function () {
					this.reset();
				});
				linhasMatriz = [];
				atualizarTabelaMatriz();
				document.location.reload();
			},


		});
	}

</script>